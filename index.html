<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>2025년 12월 결산 보고서</title>
  <style>
  :root{
    --ink:#111;
    --grid:#222;
    --muted:#666;
    --red:#d82222;

    --sheet-w: 920px;
    --pad: 18px;
    --b: 3px;
    --b2: 2px;
    --font: "Apple SD Gothic Neo","Noto Sans KR",system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;

    /* 은행표 헤더만 은은하게(요구한 “한 줄만” 느낌) */
    --c-in:  #dfe8f6;
    --c-out: #f6ddcf;
    --c-bal: #d7f1ea;
  }

  *{ box-sizing:border-box; }
  html, body{
    margin:0;
    padding:0;
    background:#f3f4f6;
    font-family:var(--font);
    color:var(--ink);
    width:100%;
    overflow-x:hidden;
    -webkit-text-size-adjust:100%;
    text-size-adjust:100%;
  }

  .stage{
    width:100%;
    padding-top:14px;
    padding-bottom:40px;
    padding-left:calc(10px + env(safe-area-inset-left));
    padding-right:calc(10px + env(safe-area-inset-right));
    overflow-x:hidden;
    position:relative;
  }

  .sheetWrap{
    width:var(--sheet-w);
    position:relative;
    left:50%;
    transform-origin: top center;
    transform: translateX(-50%) scale(var(--scale, 1));
    will-change: transform;
    backface-visibility:hidden;
    -webkit-font-smoothing: antialiased;
  }

  .sheet{
    width:var(--sheet-w);
    background:#fff;
    border:1px solid #d5d7db;
    box-shadow:0 8px 28px rgba(0,0,0,.08);
    padding:var(--pad);
  }

  input{
    width:100%;
    min-width:0;
    max-width:100%;
    border:0;
    outline:0;
    background:transparent;
    font:inherit;
    color:inherit;
    padding:0;
    margin:0;
    display:block;
    -webkit-appearance:none;
    appearance:none;
    border-radius:0;
  }
  .num{
    text-align:right;
    white-space:nowrap;
    font-variant-numeric: tabular-nums;
  }

  table{
    width:100%;
    border-collapse:collapse;
    table-layout:fixed;
  }
  th, td{
    overflow:hidden;
    white-space:nowrap;
    text-overflow:clip;
    vertical-align:middle;
    min-width:0;
  }

  /* =========================
     제목(수정 가능 + 점선 제거)
     ========================= */
  .titleWrap{
    margin:6px 0 14px;
    padding:14px 10px 12px;
    position:relative;
  }
  .titleLineTop,
  .titleLineBot{
    height:6px;
    background:linear-gradient(90deg, #9cff4a 0 44%, #6fdc33 44% 46%, #78e63a 46% 100%);
    border-radius:3px;
  }
  .titleLineTop{ margin:0 0 14px; }
  .titleLineBot{ margin:14px 0 0; background:linear-gradient(90deg, #2f7f2b 0 50%, #5fdd33 50% 52%, #2f7f2b 52% 100%); }

  .titleBox{
    border:0;
    padding:10px 14px;
    display:flex;
    justify-content:center;
    align-items:center;
    background:#fff;
  }
  .titleText{
    font-weight:1000;
    -webkit-text-stroke: 1px rgba(0,0,0,.25);
    font-size:56px;
    letter-spacing:-1px;
    line-height:1.02;
    color:#143a63;
    text-shadow: 4px 4px 0 rgba(0,0,0,.18);
    white-space:nowrap;
  }

  .summary{
    border:var(--b) solid var(--ink);
    margin:6px 0 12px;
  }
  .summaryGrid{
    display:grid;
    grid-template-columns: 1fr 1fr 1fr;
  }
  .sumCell{ border-right:var(--b) solid var(--ink); }
  .sumCell:last-child{ border-right:0; }
  .sumHead{
    border-bottom:var(--b) solid var(--ink);
    text-align:center;
    font-size:20px;
    padding:10px 8px;
    letter-spacing:2px;
    font-weight:900;
    background:#fff; /* ✅ 배경색 제거 */
  }
  .sumVal{
    text-align:center;
    font-weight:900;
    font-size:34px;
    padding:14px 10px;
    background:#fff; /* ✅ 배경색 제거 */
  }
  .sumVal.red{ color:var(--red); }
  .sumVal input{
    text-align:center;
    font-weight:900;
    font-size:34px;
  }
  .sumVal.red input{ color:var(--red); }

  .miniNote{ display:none; }

  .sectionTitle{
    display:flex;
    align-items:center;
    gap:10px;
    margin:10px 0 8px;
    font-weight:900;
    font-size:22px;
  }
  .dot{
    width:18px; height:18px;
    border:2px solid var(--ink);
    border-radius:50%;
    flex:0 0 auto;
  }

  .editText{
    display:inline-block;
    min-width:10px;
    outline:none;
    cursor:text;
  }

  .tbl{
    border:var(--b) solid var(--ink);
  }
  .tbl th, .tbl td{
    border:var(--b2) solid var(--grid);
    padding:6px 8px;
    font-size:16px;
  }
  .tbl th{
    background:#f2f2f2;
    text-align:center;
    font-weight:900;
    letter-spacing:2px;
  }
  .tbl .subhead th{
    background:#f7f7f7;
    letter-spacing:1px;
  }
  .center{ text-align:center; }
  .right{ text-align:right; }
  .bold{ font-weight:900; }

  .noteLine{
    border:var(--b) solid var(--ink);
    padding:8px 10px;
    margin:-2px 0 8px;
    font-size:14px;
    color:#222;
    text-align:center;
    font-weight:800;
  }

  .colDesc{ width:28%; }
  .colAmt{ width:16%; }
  .colDesc2{ width:28%; }
  .colAmt2{ width:16%; }
  .colBigo{ width:12%; }

  .bankWrap{
    border:var(--b) solid var(--ink);
    padding:10px;
  }
  .bankTables{
    display:grid;
    grid-template-columns: 1fr 1fr;
    gap:10px;
  }
  .bankTbl{
    border:var(--b) solid var(--ink);
  }
  .bankTbl th, .bankTbl td{
    border:var(--b2) solid var(--grid);
    padding:6px 6px;
    font-size:14px;
  }
  .bankTopTitle{
    border-bottom:var(--b2) solid var(--grid);
    font-weight:900;
    text-align:center;
    letter-spacing:4px;
    padding:6px 0;
    background:#fff;
  }

  .prevRow{
    display:grid;
    grid-template-columns: 140px 1fr;
    border-bottom:var(--b2) solid var(--grid);
  }
  .prevRow .label{
    background:#f7f7f7;
    border-right:var(--b2) solid var(--grid);
    text-align:center;
    font-weight:900;
    letter-spacing:2px;
    padding:8px 8px;
  }
  .prevRow .val{
    padding:8px 8px;
    font-weight:900;
    text-align:right;
    min-width:0;
  }

  .bankTbl col.date{ width:18%; }
  .bankTbl col.desc{ width:22%; }
  .bankTbl col.in{ width:20%; }
  .bankTbl col.out{ width:20%; }
  .bankTbl col.bal{ width:20%; }

  .bankTbl th{ background:#f2f2f2; text-align:center; font-weight:900; }

  /* ✅ 은행 “한 줄만” 색: 헤더의 입금/출금/잔액 칸만 */
  .thIn{ background:var(--c-in) !important; }
  .thOut{ background:var(--c-out) !important; }
  .thBal{ background:var(--c-bal) !important; }

  .cellDesc{ background:#fbfbfb; }
  .cellAmt{ background:#fdfdfd; }

  /* =========================
     하단: 통합잔액(그냥 전체 숫자)
     - 라벨 없음
     - 날짜/회사+대표 2줄 박스 안
     ========================= */
  .integratedBox{
    border:var(--b) solid var(--ink);
    margin-top:10px;
    padding:12px 12px 14px;
    display:flex;
    flex-direction:column;
    gap:10px;
    position:relative;
    min-height:150px;
  }

  .integratedVal{
    width:100%;
    text-align:right;
    font-size:34px;
    font-weight:900;
    color:var(--red);
    white-space:nowrap;
    overflow:hidden;
    line-height:1.05;
  }

  .integratedMeta{
    display:flex;
    flex-direction:column;
    gap:6px;
    padding-top:2px;
  }
  .metaLine1,
  .metaLine2{
    text-align:center;
    font-weight:900;
    color:#143a63;
    text-shadow: 2px 2px 0 rgba(0,0,0,.14);
    letter-spacing:-0.5px;
    font-size:30px;
    line-height:1.02;
    white-space:nowrap;
  }

  .stampOverlay{
    position:absolute;
    right:18px;
    bottom:10px;
    width:92px;
    height:92px;
    pointer-events:none;
    opacity:.92;
    transform: rotate(-2deg);
    display:none;
    z-index:5;
  }

  @media print{
    body{ background:#fff; }
    .stage{ padding:0; }
    .sheet{ border:0; box-shadow:none; }
    .sheetWrap{ transform: translateX(-50%) scale(1) !important; }
  }

  /* ===== 상단 요약 3칸 : 헤더 한 줄만 색 ===== */
  .sumCell:nth-child(1) .sumHead{ background:#e8f0fb !important; }
  .sumCell:nth-child(2) .sumHead{ background:#fde9d9 !important; }
  .sumCell:nth-child(3) .sumHead{ background:#e6f6f2 !important; }

  /* ===== 수입/지출: '적요/금액' 헤더 한 줄만 색 ===== */
  #incomeExpenseTable thead tr.subhead th:nth-child(1),
  #incomeExpenseTable thead tr.subhead th:nth-child(2){ background:#e8f0fb !important; }
  #incomeExpenseTable thead tr.subhead th:nth-child(3),
  #incomeExpenseTable thead tr.subhead th:nth-child(4){ background:#fde9d9 !important; }

  /* (중요) 본문칸은 기존 cellDesc/cellAmt 색이 있으면 제거 */
  #incomeExpenseTable tbody td.cellDesc,
  #incomeExpenseTable tbody td.cellAmt{ background:#fff !important; }

  /* ===== 모든 금액 숫자 오른쪽 끝 정렬 ===== */
  input.num, input.money{ text-align:right !important; padding-right:0 !important; }
  .sumVal, .sumVal input{ text-align:right !important; padding-right:12px !important; }

  #incomeExpenseTable td:nth-child(2),
  #incomeExpenseTable td:nth-child(4),
  #incomeExpenseTable td:nth-child(2) input,
  #incomeExpenseTable td:nth-child(4) input{
    text-align:right !important; padding-right:8px !important;
  }

  .bankTbl td,
  .bankTbl td input{ text-align:right !important; padding-right:6px !important; }

  #incSum,#expSum,#net,#netFoot,#endBal,#ibInSum,#ibOutSum,#ibEnd,#nhInSum,#nhOutSum,#nhEnd{
    text-align:right !important; padding-right:6px !important;
  }

  /* 도장 */
  .ceoStamp{ height:34px; margin-left:10px; vertical-align:middle; opacity:0.9; }
  .nameLast{ position:relative; display:inline-block; z-index:2; }
  .ceoStampBig{
    position:absolute;
    width:90px;
    height:90px;
    left:50%;
    top:50%;
    transform:translate(-50%, -50%);
    opacity:0.9;
    pointer-events:none;
    z-index:1;
  }
  .signLine{
    font-weight:900;
    font-size:30px;
    color:#143a63;
    letter-spacing:-0.5px;
    line-height:1.02;
    white-space:nowrap;
  }

  /* ===============================
     ✅ 추가: 적요(본문) 전체 가운데 정렬
     =============================== */
  #incomeExpenseTable tbody td.cellDesc,
  #incomeExpenseTable tbody td.cellDesc input{
    text-align:center !important;
  }

  .bankTbl tbody td:nth-child(1),
  .bankTbl tbody td:nth-child(1) input,
  .bankTbl tbody td:nth-child(2),
  .bankTbl tbody td:nth-child(2) input{
    text-align:center !important;
    padding-right:0 !important;
  }

  /* ===============================
     ✅ 추가: 은행 거래내역 전월이월액/합계잔액 숫자만 빨강
     =============================== */
  #ibPrev, #nhPrev, #ibEnd, #nhEnd{
    color: var(--red) !important;
  }

  /* ===============================
     ✅ 추가: 모든 글자/숫자 굵게
     =============================== */
  body,
  input,
  textarea,
  select,
  table,
  th,
  td,
  span,
  div{
    font-weight:900 !important;
  }
</style>
</head>
   <body>
    <div class="stage">
    <div class="sheetWrap" id="sheetWrap">
      <div class="sheet" id="sheet">

        <div class="titleWrap">
          <div class="titleLineTop"></div>
          <div class="titleBox">
            <div class="titleText editText" contenteditable="true">2025년&nbsp;&nbsp;12월&nbsp;&nbsp;결산&nbsp;&nbsp;보고서</div>
          </div>
          <div class="titleLineBot"></div>
        </div>

        <div class="summary">
          <div class="summaryGrid">
            <div class="sumCell">
              <div class="sumHead"><span class="editText" contenteditable="true">11월 이월금액</span></div>
              <div class="sumVal"><input id="carry" class="num money" inputmode="numeric" value="25,554,575"></div>
            </div>
            <div class="sumCell">
              <div class="sumHead"><span class="editText" contenteditable="true">수 입 - 지 출</span></div>
              <div class="sumVal"><input id="net" class="num" value="0" readonly></div>
            </div>
            <div class="sumCell">
              <div class="sumHead"><span class="editText" contenteditable="true">12월 31일 통 장 잔 액</span></div>
              <div class="sumVal red"><input id="endBal" class="num" value="0" readonly></div>
            </div>
          </div>
        </div>

        <div class="miniNote"></div>

        <div class="sectionTitle">
          <span class="dot"></span>
          <span class="editText" contenteditable="true" id="titleIncomeExpense">12월 수입/지출 내역서</span>
        </div>

        <div class="noteLine">
          <span class="editText" contenteditable="true">（ 현재 REC  보유량 : ）</span>
        </div>

        <table class="tbl" id="incomeExpenseTable">
          <colgroup>
            <col class="colDesc"><col class="colAmt">
            <col class="colDesc2"><col class="colAmt2">
            <col class="colBigo">
          </colgroup>
          <thead>
            <tr>
              <th colspan="2">수&nbsp;&nbsp;입</th>
              <th colspan="2">지&nbsp;&nbsp;출</th>
              <th>비&nbsp;&nbsp;고</th>
            </tr>
            <tr class="subhead">
              <th class="center">적&nbsp;&nbsp;요</th>
              <th class="center">금&nbsp;&nbsp;액</th>
              <th class="center">적&nbsp;&nbsp;요</th>
              <th class="center">금&nbsp;&nbsp;액</th>
              <th class="center"></th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="cellDesc"><input value="1차 SMP"></td>
              <td class="cellAmt"><input class="num money inc" inputmode="numeric" value="8,508,100"></td>
              <td class="cellDesc"><input value="송전료"></td>
              <td class="cellAmt"><input class="num money exp" inputmode="numeric" value="347,720"></td>
              <td><input value=""></td>
            </tr>
            <tr>
              <td class="cellDesc"><input value="2차 SMP"></td>
              <td class="cellAmt"><input class="num money inc" inputmode="numeric" value="6,967,300"></td>
              <td class="cellDesc"><input value="이사회식대"></td>
              <td class="cellAmt"><input class="num money exp" inputmode="numeric" value="52,000"></td>
              <td><input value=""></td>
            </tr>
            <tr>
              <td class="cellDesc"><input value="3차 SMP"></td>
              <td class="cellAmt"><input class="num money inc" inputmode="numeric" value="4,527,300"></td>
              <td class="cellDesc"><input value="사람과사람세무사"></td>
              <td class="cellAmt"><input class="num money exp" inputmode="numeric" value="154,000"></td>
              <td><input value=""></td>
            </tr>
            <tr>
              <td class="cellDesc"><input value="4차 SMP"></td>
              <td class="cellAmt"><input class="num money inc" inputmode="numeric" value="1,895,650"></td>
              <td class="cellDesc"><input value="보상금"></td>
              <td class="cellAmt"><input class="num money exp" inputmode="numeric" value="10,500,500"></td>
              <td><input value=""></td>
            </tr>
            <tr>
              <td class="cellDesc"><input value="KT 전력예측"></td>
              <td class="cellAmt"><input class="num money inc" inputmode="numeric" value="0"></td>
              <td class="cellDesc"><input value="대표,이사회수당"></td>
              <td class="cellAmt"><input class="num money exp" inputmode="numeric" value="800,000"></td>
              <td><input value=""></td>
            </tr>
            <tr>
              <td class="cellDesc"><input value="rec"></td>
              <td class="cellAmt"><input class="num money inc" inputmode="numeric" value="0"></td>
              <td class="cellDesc"><input value="군청근조화환"></td>
              <td class="cellAmt"><input class="num money exp" inputmode="numeric" value="100,000"></td>
              <td><input value=""></td>
            </tr>
            <tr>
              <td class="cellDesc"><input value="이자"></td>
              <td class="cellAmt"><input class="num money inc" inputmode="numeric" value="946"></td>
              <td class="cellDesc"><input value="이음북스"></td>
              <td class="cellAmt"><input class="num money exp" inputmode="numeric" value="93,700"></td>
              <td><input value=""></td>
            </tr>
            <tr>
              <td class="cellDesc"><input value="이자"></td>
              <td class="cellAmt"><input class="num money inc" inputmode="numeric" value="5,492"></td>
              <td class="cellDesc"><input value="토지임대료"></td>
              <td class="cellAmt"><input class="num money exp" inputmode="numeric" value="14,300,000"></td>
              <td><input value=""></td>
            </tr>
            <tr>
              <td class="cellDesc"><input value=""></td>
              <td class="cellAmt"><input class="num money inc" inputmode="numeric" value="0"></td>
              <td class="cellDesc"><input value="운영비"></td>
              <td class="cellAmt"><input class="num money exp" inputmode="numeric" value="11,000,500"></td>
              <td><input value=""></td>
            </tr>

            <tr><td class="cellDesc"><input value=""></td><td class="cellAmt"><input class="num money inc" inputmode="numeric" value="0"></td><td class="cellDesc"><input value=""></td><td class="cellAmt"><input class="num money exp" inputmode="numeric" value="0"></td><td><input value=""></td></tr>
            <tr><td class="cellDesc"><input value=""></td><td class="cellAmt"><input class="num money inc" inputmode="numeric" value="0"></td><td class="cellDesc"><input value=""></td><td class="cellAmt"><input class="num money exp" inputmode="numeric" value="0"></td><td><input value=""></td></tr>
            <tr><td class="cellDesc"><input value=""></td><td class="cellAmt"><input class="num money inc" inputmode="numeric" value="0"></td><td class="cellDesc"><input value=""></td><td class="cellAmt"><input class="num money exp" inputmode="numeric" value="0"></td><td><input value=""></td></tr>
          </tbody>

          <tfoot>
            <tr>
              <th class="center">합&nbsp;&nbsp;계</th>
              <th class="right"><input id="incSum" class="num" readonly value="0"></th>
              <th class="center">합&nbsp;&nbsp;계</th>
              <th class="right"><input id="expSum" class="num" readonly value="0"></th>
              <th class="right"><input id="netFoot" class="num" readonly value="0"></th>
            </tr>
          </tfoot>
        </table>

        <div class="sectionTitle" style="margin-top:14px;">
          <span class="dot"></span>
          <span class="editText" contenteditable="true" id="titleBank">12월 은행 입출금 내역</span>
        </div>

        <div class="bankWrap">
          <div class="bankTables">

            <div>
              <div class="bankTopTitle"><span class="editText" contenteditable="true">기 업 은 행</span></div>
              <div class="prevRow">
                <div class="label"><span class="editText" contenteditable="true">전월이월액</span></div>
                <div class="val"><input id="ibPrev" class="num money" inputmode="numeric" value="15,541,634"></div>
              </div>

              <table class="bankTbl" id="ibTable">
                <colgroup><col class="date"><col class="desc"><col class="in"><col class="out"><col class="bal"></colgroup>
                <thead>
                  <tr>
                    <th class="center">날&nbsp;&nbsp;짜</th>
                    <th class="center">적&nbsp;&nbsp;요</th>
                    <th class="center thIn">입&nbsp;&nbsp;금</th>
                    <th class="center thOut">출&nbsp;&nbsp;금</th>
                    <th class="center thBal">잔&nbsp;&nbsp;액</th>
                  </tr>
                </thead>
                <tbody>
                  <tr><td class="cellDesc"><input value=""></td><td class="cellDesc"><input value="전력거래소"></td><td class="cellAmt"><input class="num money ib-in" inputmode="numeric" value="8,508,100"></td><td class="cellAmt"><input class="num money ib-out" inputmode="numeric" value="0"></td><td><input class="num ib-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value=""></td><td class="cellDesc"><input value="염전마을주"></td><td class="cellAmt"><input class="num money ib-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money ib-out" inputmode="numeric" value="15,500,000"></td><td><input class="num ib-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value=""></td><td class="cellDesc"><input value="이자"></td><td class="cellAmt"><input class="num money ib-in" inputmode="numeric" value="946"></td><td class="cellAmt"><input class="num money ib-out" inputmode="numeric" value="0"></td><td><input class="num ib-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value=""></td><td class="cellDesc"><input value="전력거래소"></td><td class="cellAmt"><input class="num money ib-in" inputmode="numeric" value="6,967,300"></td><td class="cellAmt"><input class="num money ib-out" inputmode="numeric" value="0"></td><td><input class="num ib-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value=""></td><td class="cellDesc"><input value="전력거래소"></td><td class="cellAmt"><input class="num money ib-in" inputmode="numeric" value="4,527,300"></td><td class="cellAmt"><input class="num money ib-out" inputmode="numeric" value="0"></td><td><input class="num ib-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value=""></td><td class="cellDesc"><input value="염전마을주"></td><td class="cellAmt"><input class="num money ib-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money ib-out" inputmode="numeric" value="14,300,000"></td><td><input class="num ib-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value=""></td><td class="cellDesc"><input value="전력거래소"></td><td class="cellAmt"><input class="num money ib-in" inputmode="numeric" value="1,895,650"></td><td class="cellAmt"><input class="num money ib-out" inputmode="numeric" value="0"></td><td><input class="num ib-bal" readonly></td></tr>

                  <tr><td class="cellDesc"><input value=""></td><td class="cellDesc"><input value=""></td><td class="cellAmt"><input class="num money ib-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money ib-out" inputmode="numeric" value="0"></td><td><input class="num ib-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value=""></td><td class="cellDesc"><input value=""></td><td class="cellAmt"><input class="num money ib-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money ib-out" inputmode="numeric" value="0"></td><td><input class="num ib-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value=""></td><td class="cellDesc"><input value=""></td><td class="cellAmt"><input class="num money ib-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money ib-out" inputmode="numeric" value="0"></td><td><input class="num ib-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value=""></td><td class="cellDesc"><input value=""></td><td class="cellAmt"><input class="num money ib-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money ib-out" inputmode="numeric" value="0"></td><td><input class="num ib-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value=""></td><td class="cellDesc"><input value=""></td><td class="cellAmt"><input class="num money ib-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money ib-out" inputmode="numeric" value="0"></td><td><input class="num ib-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value=""></td><td class="cellDesc"><input value=""></td><td class="cellAmt"><input class="num money ib-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money ib-out" inputmode="numeric" value="0"></td><td><input class="num ib-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value=""></td><td class="cellDesc"><input value=""></td><td class="cellAmt"><input class="num money ib-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money ib-out" inputmode="numeric" value="0"></td><td><input class="num ib-bal" readonly></td></tr>
                </tbody>
                <tfoot>
                  <tr>
                    <th class="center">합&nbsp;&nbsp;계</th>
                    <th class="right"></th>
                    <th class="right"><input id="ibInSum" class="num" readonly></th>
                    <th class="right"><input id="ibOutSum" class="num" readonly></th>
                    <th class="right"><input id="ibEnd" class="num" readonly></th>
                  </tr>
                </tfoot>
              </table>
            </div>

            <div>
              <div class="bankTopTitle"><span class="editText" contenteditable="true">농&nbsp;&nbsp;협</span></div>
              <div class="prevRow">
                <div class="label"><span class="editText" contenteditable="true">전월이월액</span></div>
                <div class="val"><input id="nhPrev" class="num money" inputmode="numeric" value="10,012,941"></div>
              </div>

              <table class="bankTbl" id="nhTable">
                <colgroup><col class="date"><col class="desc"><col class="in"><col class="out"><col class="bal"></colgroup>
                <thead>
                  <tr>
                    <th class="center">날&nbsp;&nbsp;짜</th>
                    <th class="center">적&nbsp;&nbsp;요</th>
                    <th class="center thIn">입&nbsp;&nbsp;금</th>
                    <th class="center thOut">출&nbsp;&nbsp;금</th>
                    <th class="center thBal">잔&nbsp;&nbsp;액</th>
                  </tr>
                </thead>
                <tbody>
                  <tr><td class="cellDesc"><input value=""></td><td class="cellDesc"><input value="이음북스"></td><td class="cellAmt"><input class="num money nh-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money nh-out" inputmode="numeric" value="93,700"></td><td><input class="num nh-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value=""></td><td class="cellDesc"><input value="이사회식대"></td><td class="cellAmt"><input class="num money nh-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money nh-out" inputmode="numeric" value="52,000"></td><td><input class="num nh-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value=""></td><td class="cellDesc"><input value="염전마을주"></td><td class="cellAmt"><input class="num money nh-in" inputmode="numeric" value="15,500,000"></td><td class="cellAmt"><input class="num money nh-out" inputmode="numeric" value="0"></td><td><input class="num nh-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value=""></td><td class="cellDesc"><input value="송전료"></td><td class="cellAmt"><input class="num money nh-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money nh-out" inputmode="numeric" value="347,720"></td><td><input class="num nh-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value=""></td><td class="cellDesc"><input value="김균태회계"></td><td class="cellAmt"><input class="num money nh-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money nh-out" inputmode="numeric" value="154,000"></td><td><input class="num nh-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value=""></td><td class="cellDesc"><input value="보상금"></td><td class="cellAmt"><input class="num money nh-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money nh-out" inputmode="numeric" value="10,500,500"></td><td><input class="num nh-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value=""></td><td class="cellDesc"><input value="대표,이사회수당"></td><td class="cellAmt"><input class="num money nh-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money nh-out" inputmode="numeric" value="800,000"></td><td><input class="num nh-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value=""></td><td class="cellDesc"><input value="군청근조화환"></td><td class="cellAmt"><input class="num money nh-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money nh-out" inputmode="numeric" value="100,000"></td><td><input class="num nh-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value=""></td><td class="cellDesc"><input value="운영비"></td><td class="cellAmt"><input class="num money nh-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money nh-out" inputmode="numeric" value="11,000,500"></td><td><input class="num nh-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value=""></td><td class="cellDesc"><input value="이자"></td><td class="cellAmt"><input class="num money nh-in" inputmode="numeric" value="5,492"></td><td class="cellAmt"><input class="num money nh-out" inputmode="numeric" value="0"></td><td><input class="num nh-bal" readonly></td></tr>

                  <tr><td class="cellDesc"><input value=""></td><td class="cellDesc"><input value=""></td><td class="cellAmt"><input class="num money nh-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money nh-out" inputmode="numeric" value="0"></td><td><input class="num nh-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value=""></td><td class="cellDesc"><input value=""></td><td class="cellAmt"><input class="num money nh-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money nh-out" inputmode="numeric" value="0"></td><td><input class="num nh-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value=""></td><td class="cellDesc"><input value=""></td><td class="cellAmt"><input class="num money nh-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money nh-out" inputmode="numeric" value="0"></td><td><input class="num nh-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value=""></td><td class="cellDesc"><input value=""></td><td class="cellAmt"><input class="num money nh-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money nh-out" inputmode="numeric" value="0"></td><td><input class="num nh-bal" readonly></td></tr>
                </tbody>
                <tfoot>
                  <tr>
                    <th class="center">합&nbsp;&nbsp;계</th>
                    <th class="right"></th>
                    <th class="right"><input id="nhInSum" class="num" readonly></th>
                    <th class="right"><input id="nhOutSum" class="num" readonly></th>
                    <th class="right"><input id="nhEnd" class="num" readonly></th>
                  </tr>
                </tfoot>
              </table>
            </div>

          </div>
        </div>

        <div class="integratedBox">
          <div class="integratedVal" id="integratedBal">0</div>

          <div class="integratedMeta">
            <div class="metaLine1">
              <span class="editText" id="reportDateText" contenteditable="true">2025년 12월 31일</span>
            </div>

            <div class="metaLine2">
              <span class="editText signLine" contenteditable="true">
                염전마을주민발전주식회사&nbsp;&nbsp;대표이사&nbsp;&nbsp;
                김&nbsp;&nbsp;진&nbsp;&nbsp;
                <span class="nameLast">
                  욱
                  <img src="stamp.PNG" class="ceoStampBig" alt="직인">
                </span>
              </span>
            </div>
          </div>
        </div>

<script>
  /* ===== iPhone “한 장 자동 축소” ===== */
  (function(){
    const wrap = document.getElementById('sheetWrap');
    const stage = document.querySelector('.stage');
    function px(v){ return Number(String(v).replace('px','')) || 0; }

    function fit(){
      if(!wrap || !stage) return;
      const vw = document.documentElement.clientWidth;
      const base = parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--sheet-w')) || 920;

      const st = getComputedStyle(stage);
      const padL = px(st.paddingLeft);
      const padR = px(st.paddingRight);

      const usable = Math.max(320, vw - padL - padR);
      const scale = Math.min(1, usable / base);
      wrap.style.setProperty('--scale', scale.toFixed(4));
    }
    window.addEventListener('resize', fit, {passive:true});
    fit();
  })();

  /* ===== (요구2) 맨 아래 빨간 숫자: 지금부터 영구 숨김 ===== */
  function hideIntegratedBalForever(){
    const el = document.getElementById('integratedBal');
    if(el) el.style.display = 'none';
  }
  hideIntegratedBalForever();

  /* ===== 숫자/포맷 (커서 튐 방지: input 중엔 포맷X, blur 때만 콤마) ===== */
  function toNumber(v){
    if (v == null) return 0;
    const s = String(v).replace(/[^\d\-]/g,'');
    if (s === '' || s === '-') return 0;
    const n = Number(s);
    return Number.isFinite(n) ? n : 0;
  }
  function fmt(n){
    const sign = n < 0 ? '-' : '';
    const abs = Math.abs(Math.round(n));
    return sign + abs.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
  }
  function normalizeMoneyInput(el){
    el.value = fmt(toNumber(el.value));
  }

  /* ===== 계산 ===== */
  function sumInputs(selector){
    let s = 0;
    document.querySelectorAll(selector).forEach(el=>{ s += toNumber(el.value); });
    return s;
  }

  function recalcIncomeExpense(){
    const inc = sumInputs('#incomeExpenseTable .inc');
    const exp = sumInputs('#incomeExpenseTable .exp');
    const net = inc - exp;

    const incSumEl = document.getElementById('incSum');
    const expSumEl = document.getElementById('expSum');
    const netFootEl = document.getElementById('netFoot');
    const netEl = document.getElementById('net');
    const carryEl = document.getElementById('carry');
    const endBalEl = document.getElementById('endBal');

    if(incSumEl) incSumEl.value = fmt(inc);
    if(expSumEl) expSumEl.value = fmt(exp);
    if(netFootEl) netFootEl.value = fmt(net);
    if(netEl) netEl.value = fmt(net);

    const carry = carryEl ? toNumber(carryEl.value) : 0;
    if(endBalEl) endBalEl.value = fmt(carry + net);
  }

  function recalcBankOne(prefixTableSel, prevId, inSel, outSel, balSel, inSumId, outSumId, endId){
    const prevEl = document.getElementById(prevId);
    let bal = prevEl ? toNumber(prevEl.value) : 0;
    let inSum = 0, outSum = 0;

    document.querySelectorAll(prefixTableSel + ' tbody tr').forEach(tr=>{
      const inEl  = tr.querySelector(inSel);
      const outEl = tr.querySelector(outSel);
      const balEl = tr.querySelector(balSel);

      const inn = inEl ? toNumber(inEl.value) : 0;
      const out = outEl ? toNumber(outEl.value) : 0;

      inSum += inn;
      outSum += out;

      bal = bal + inn - out;
      if (balEl) balEl.value = fmt(bal);
    });

    const inSumEl = document.getElementById(inSumId);
    const outSumEl = document.getElementById(outSumId);
    const endEl = document.getElementById(endId);

    if(inSumEl) inSumEl.value = fmt(inSum);
    if(outSumEl) outSumEl.value = fmt(outSum);
    if(endEl) endEl.value = fmt(bal);

    return bal;
  }

  function recalcBank(){
    const ibEnd = recalcBankOne('#ibTable', 'ibPrev', '.ib-in', '.ib-out', '.ib-bal', 'ibInSum','ibOutSum','ibEnd');
    const nhEnd = recalcBankOne('#nhTable', 'nhPrev', '.nh-in', '.nh-out', '.nh-bal', 'nhInSum','nhOutSum','nhEnd');

    // 통합잔액은 계산은 하되, 화면에 표시 안 함(요구사항)
    const el = document.getElementById('integratedBal');
    if (el){
      el.textContent = fmt(ibEnd + nhEnd);
      el.style.display = 'none';
    }
  }

  function recalcAll(){
    recalcIncomeExpense();
    recalcBank();
  }

  /* =========================================================
     ✅ 저장(로컬) + ✅ 월 변경 시 초기화 규칙
     1) 월 초기화 시 money 전부 0
     2) 단, carry(이월잔액) = 지난달 endBal 값
     ========================================================= */

  const STORAGE_PREFIX = 'YEOMJEON_SETTLEMENT_REPORT_V1';

  function monthKey(d){
    const y = d.getFullYear();
    const m = String(d.getMonth()+1).padStart(2,'0');
    return `${y}-${m}`;
  }
  function storageKeyForMonth(mk){
    return `${STORAGE_PREFIX}:${mk}`;
  }
  function prevMonthKey(now){
    const d = new Date(now.getFullYear(), now.getMonth(), 1);
    d.setMonth(d.getMonth() - 1);
    return monthKey(d);
  }

  function todayKoreanDate(d){
    const y = d.getFullYear();
    const m = d.getMonth()+1;
    const day = d.getDate();
    return `${y}년 ${m}월 ${day}일`;
  }

  function snapshotDefaults(){
    document.querySelectorAll('input').forEach((el)=>{
      if (el.dataset.def == null) el.dataset.def = (el.value ?? '');
    });
    document.querySelectorAll('[contenteditable="true"]').forEach((el)=>{
      if (el.dataset.def == null) el.dataset.def = (el.innerHTML ?? '');
    });
  }

  // 기본 문구 그대로일 때만 현재 월로 자동 교체
  function autoPatchMonthTextIfDefault(){
    const now = new Date();
    const y = now.getFullYear();
    const m = now.getMonth()+1;

    /* ✅ (수정) 상단 첫칸 "이월금액" 헤더는 저장 여부와 상관없이 '지난달'로 자동 표기 */
    const carryHead = document.querySelector('.summary .sumCell:nth-child(1) .sumHead [contenteditable="true"]');
    if (carryHead){
      const prev = new Date(now.getFullYear(), now.getMonth() - 1, 1); // 지난달
      const pm = prev.getMonth() + 1;
      carryHead.innerText = `${pm}월 이월금액`;
    }

    const titleEl = document.querySelector('.titleText[contenteditable="true"]');
    if (titleEl && titleEl.dataset.def != null && titleEl.innerHTML === titleEl.dataset.def){
      titleEl.innerHTML = `${y}년&nbsp;&nbsp;${m}월&nbsp;&nbsp;결산&nbsp;&nbsp;보고서`;
    }

    const ieTitle = document.getElementById('titleIncomeExpense');
    if (ieTitle && ieTitle.dataset.def != null && ieTitle.innerHTML === ieTitle.dataset.def){
      ieTitle.innerHTML = `${m}월 수입/지출 내역서`;
    }

    const bankTitle = document.getElementById('titleBank');
    if (bankTitle && bankTitle.dataset.def != null && bankTitle.innerHTML === bankTitle.dataset.def){
      bankTitle.innerHTML = `${m}월 은행 입출금 내역`;
    }

    const heads = document.querySelectorAll('.summary .sumHead [contenteditable="true"]');
    heads.forEach(h=>{
      if(!h.dataset.def) return;
      if(h.innerHTML !== h.dataset.def) return;
      const t = (h.innerText || '').replace(/\s+/g,'');
      if(t.includes('월31일') && t.includes('통장') && t.includes('잔액')){
        h.innerText = `${m}월 31일 통 장 잔 액`;
      }
    });
  }

  function setBottomDateToToday(){
    const el = document.getElementById('reportDateText');
    if(el) el.innerText = todayKoreanDate(new Date());
  }

  function collectState(){
    const state = {
      mk: monthKey(new Date()),
      inputs: {},
      edits: {}
    };

    document.querySelectorAll('input').forEach((el, idx)=>{
      const key = el.id ? `id:${el.id}` : `idx:${idx}`;
      state.inputs[key] = (el.value ?? '');
    });

    document.querySelectorAll('[contenteditable="true"]').forEach((el, idx)=>{
      const key = el.id ? `id:${el.id}` : `idx:${idx}`;
      state.edits[key] = (el.innerHTML ?? '');
    });

    return state;
  }

  function applyState(state){
    if(!state) return;

    document.querySelectorAll('input').forEach((el, idx)=>{
      const key = el.id ? `id:${el.id}` : `idx:${idx}`;
      if(state.inputs && Object.prototype.hasOwnProperty.call(state.inputs, key)){
        el.value = state.inputs[key];
      }
    });

    document.querySelectorAll('[contenteditable="true"]').forEach((el, idx)=>{
      const key = el.id ? `id:${el.id}` : `idx:${idx}`;
      if(state.edits && Object.prototype.hasOwnProperty.call(state.edits, key)){
        el.innerHTML = state.edits[key];
      }
    });
  }

  function saveStateForKey(storageKey){
    try{
      localStorage.setItem(storageKey, JSON.stringify(collectState()));
    }catch(e){}
  }

  function loadStateForKey(storageKey){
    try{
      const raw = localStorage.getItem(storageKey);
      if(!raw) return null;
      return JSON.parse(raw);
    }catch(e){
      return null;
    }
  }

  // ✅ 월 초기화 규칙(요구사항)
  function resetForNewMonth(prevEndBalValue){
    const carryEl = document.getElementById('carry');
    if(carryEl){
      carryEl.value = (prevEndBalValue != null && prevEndBalValue !== '') ? prevEndBalValue : '0';
    }

    // money 전부 0 (carry 제외)
    document.querySelectorAll('input.money').forEach(el=>{
      if(el.id === 'carry') return;
      el.value = '0';
    });

    // 계산표시 칸들도 0으로(표시 안정)
    ['net','endBal','incSum','expSum','netFoot','ibInSum','ibOutSum','ibEnd','nhInSum','nhOutSum','nhEnd'].forEach(id=>{
      const el = document.getElementById(id);
      if(el) el.value = '0';
    });

    hideIntegratedBalForever();
  }

  // 저장 디바운스
  let saveTimer = null;
  function scheduleSave(storageKey){
    clearTimeout(saveTimer);
    saveTimer = setTimeout(()=>saveStateForKey(storageKey), 250);
  }

  /* ===== 이벤트 바인딩 ===== */
  function bindMoneyEvents(storageKey){
    document.querySelectorAll('input.money').forEach(el=>{
      el.addEventListener('input', ()=>{
        recalcAll();
        scheduleSave(storageKey);
      });
      el.addEventListener('blur', ()=>{
        normalizeMoneyInput(el);
        recalcAll();
        scheduleSave(storageKey);
      });
      normalizeMoneyInput(el);
    });

    document.querySelectorAll('input:not(.money)').forEach(el=>{
      el.addEventListener('input', ()=>scheduleSave(storageKey));
      el.addEventListener('change', ()=>scheduleSave(storageKey));
    });
  }

  function bindEditableSaves(storageKey){
    document.querySelectorAll('[contenteditable="true"]').forEach(el=>{
      el.addEventListener('input', ()=>scheduleSave(storageKey));
      el.addEventListener('blur', ()=>scheduleSave(storageKey));
    });
  }

  /* ===== 부팅 ===== */
  (function boot(){
    snapshotDefaults();
    hideIntegratedBalForever();

    const now = new Date();
    const mkNow = monthKey(now);
    const keyNow = storageKeyForMonth(mkNow);

    const savedNow = loadStateForKey(keyNow);

    if(savedNow){
      // 같은 달: 그대로 복원
      applyState(savedNow);
    }else{
      // 새 달: 지난달 endBal을 carry로 가져오고 나머지는 0
      const mkPrev = prevMonthKey(now);
      const keyPrev = storageKeyForMonth(mkPrev);
      const savedPrev = loadStateForKey(keyPrev);

      let prevEndBal = '0';
      if(savedPrev && savedPrev.inputs && savedPrev.inputs['id:endBal'] != null){
        prevEndBal = savedPrev.inputs['id:endBal'];
      }

      /* ✅ (추가) 월이 바뀌면 지난달 은행 '합계잔액'을 이번달 '전월이월액'으로 자동 세팅 */
      let prevIbEnd = '0';
      if(savedPrev && savedPrev.inputs && savedPrev.inputs['id:ibEnd'] != null){
        prevIbEnd = savedPrev.inputs['id:ibEnd'];
      }
      let prevNhEnd = '0';
      if(savedPrev && savedPrev.inputs && savedPrev.inputs['id:nhEnd'] != null){
        prevNhEnd = savedPrev.inputs['id:nhEnd'];
      }

      resetForNewMonth(prevEndBal);

      const ibPrevEl = document.getElementById('ibPrev');
      if(ibPrevEl) ibPrevEl.value = prevIbEnd;
      const nhPrevEl = document.getElementById('nhPrev');
      if(nhPrevEl) nhPrevEl.value = prevNhEnd;

      // 월/날짜 자동 반영(기본 문구일 때만)
      autoPatchMonthTextIfDefault();
      setBottomDateToToday();

      saveStateForKey(keyNow);
    }

    bindMoneyEvents(keyNow);
    bindEditableSaves(keyNow);

    recalcAll();
    document.querySelectorAll('input.money').forEach(normalizeMoneyInput);

    hideIntegratedBalForever();

    /* ✅ (추가) 저장 복원/신규달 모두에서 '지난달 이월금액'을 확실히 적용 */
    autoPatchMonthTextIfDefault();

    saveStateForKey(keyNow);
  })();
</script>
</body>
</html>







