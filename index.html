<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>2025년 12월 결산 보고서</title>
  <style>
    :root{
      --ink:#111;
      --grid:#222;
      --muted:#666;
      --red:#d82222;

      --sheet-w: 920px;
      --pad: 18px;
      --b: 3px;
      --b2: 2px;
      --font: "Apple SD Gothic Neo","Noto Sans KR",system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;

      --c-in:  #dfe8f6;
      --c-out: #f6ddcf;
      --c-bal: #d7f1ea;
    }

    *{ box-sizing:border-box; }
    html, body{
      margin:0;
      padding:0;
      background:#f3f4f6;
      font-family:var(--font);
      color:var(--ink);
      width:100%;
      overflow-x:hidden;                 /* 가로스크롤 방지 */
      -webkit-text-size-adjust:100%;
      text-size-adjust:100%;
    }

    /* ✅ iPhone 안전영역 + 좌우 여유를 확실히 */
    .stage{
      width:100%;
      padding-top:14px;
      padding-bottom:40px;
      padding-left:calc(10px + env(safe-area-inset-left));
      padding-right:calc(10px + env(safe-area-inset-right));
      overflow-x:hidden;                 /* 혹시 삐져나와도 숨김 */
      position:relative;
    }

    /* ✅ iOS에서 scale + center가 소수점으로 밀려 좌측이 잘리는 현상 방지:
       margin:auto 대신 left:50% + translateX(-50%)로 강제 중앙 고정 */
    .sheetWrap{
      width:var(--sheet-w);
      position:relative;
      left:50%;
      transform-origin: top center;
      transform: translateX(-50%) scale(var(--scale, 1));
      will-change: transform;
      backface-visibility:hidden;
      -webkit-font-smoothing: antialiased;
    }

    .sheet{
      width:var(--sheet-w);
      background:#fff;
      border:1px solid #d5d7db;
      box-shadow:0 8px 28px rgba(0,0,0,.08);
      padding:var(--pad);
    }

    input{
      width:100%;
      min-width:0;
      max-width:100%;
      border:0;
      outline:0;
      background:transparent;
      font:inherit;
      color:inherit;
      padding:0;
      margin:0;
      display:block;
      -webkit-appearance:none;
      appearance:none;
      border-radius:0;
    }
    .num{
      text-align:right;
      white-space:nowrap;
      font-variant-numeric: tabular-nums;
    }

    table{
      width:100%;
      border-collapse:collapse;
      table-layout:fixed;
    }
    th, td{
      overflow:hidden;
      white-space:nowrap;
      text-overflow:clip;
      vertical-align:middle;
      min-width:0;
    }

    .title{
      text-align:center;
      font-weight:900;
      font-size:56px;
      letter-spacing:-1px;
      margin:6px 0 14px;
      color:#143a63;
      line-height:1.02;
    }

    .summary{
      border:var(--b) solid var(--ink);
      margin:6px 0 12px;
    }
    .summaryGrid{
      display:grid;
      grid-template-columns: 1fr 1fr 1fr;
    }
    .sumCell{ border-right:var(--b) solid var(--ink); }
    .sumCell:last-child{ border-right:0; }
    .sumHead{
      border-bottom:var(--b) solid var(--ink);
      text-align:center;
      font-size:20px;
      padding:10px 8px;
      letter-spacing:2px;
      font-weight:900;
    }
    .sumVal{
      text-align:center;
      font-weight:900;
      font-size:34px;
      padding:14px 10px;
    }
    .sumVal.red{ color:var(--red); }
    .sumVal input{
      text-align:center;
      font-weight:900;
      font-size:34px;
    }
    .sumVal.red input{ color:var(--red); }

    .miniNote{ display:none; }

    .sectionTitle{
      display:flex;
      align-items:center;
      gap:10px;
      margin:10px 0 8px;
      font-weight:900;
      font-size:22px;
    }
    .dot{
      width:18px; height:18px;
      border:2px solid var(--ink);
      border-radius:50%;
      flex:0 0 auto;
    }
    .editText{
      display:inline-block;
      min-width:10px;
      outline:none;
      cursor:text;
    }

    .tbl{
      border:var(--b) solid var(--ink);
    }
    .tbl th, .tbl td{
      border:var(--b2) solid var(--grid);
      padding:6px 8px;
      font-size:16px;
    }
    .tbl th{
      background:#f2f2f2;
      text-align:center;
      font-weight:900;
      letter-spacing:2px;
    }
    .tbl .subhead th{
      background:#f7f7f7;
      letter-spacing:1px;
    }
    .center{ text-align:center; }
    .right{ text-align:right; }
    .bold{ font-weight:900; }

    .noteLine{
      border:var(--b) solid var(--ink);
      padding:8px 10px;
      margin:-2px 0 8px;
      font-size:14px;
      color:#222;
      text-align:center;
      font-weight:800;
    }

    .colDesc{ width:28%; }
    .colAmt{ width:16%; }
    .colDesc2{ width:28%; }
    .colAmt2{ width:16%; }
    .colBigo{ width:12%; }

    .bankWrap{
      border:var(--b) solid var(--ink);
      padding:10px;
    }
    .bankTables{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
    }
    .bankTbl{
      border:var(--b) solid var(--ink);
    }
    .bankTbl th, .bankTbl td{
      border:var(--b2) solid var(--grid);
      padding:6px 6px;
      font-size:14px;
    }
    .bankTopTitle{
      border-bottom:var(--b2) solid var(--grid);
      font-weight:900;
      text-align:center;
      letter-spacing:4px;
      padding:6px 0;
      background:#fff;
    }

    .prevRow{
      display:grid;
      grid-template-columns: 140px 1fr;
      border-bottom:var(--b2) solid var(--grid);
    }
    .prevRow .label{
      background:#f7f7f7;
      border-right:var(--b2) solid var(--grid);
      text-align:center;
      font-weight:900;
      letter-spacing:2px;
      padding:8px 8px;
    }
    .prevRow .val{
      padding:8px 8px;
      font-weight:900;
      text-align:right;
      min-width:0;
    }

    .bankTbl col.desc{ width:28%; }
    .bankTbl col.in{ width:24%; }
    .bankTbl col.out{ width:24%; }
    .bankTbl col.bal{ width:24%; }

    .bankTbl th{ background:#f2f2f2; text-align:center; font-weight:900; }
    .thIn{ background:var(--c-in) !important; }
    .thOut{ background:var(--c-out) !important; }
    .thBal{ background:var(--c-bal) !important; }

    .cellDesc{ background:#fbfbfb; }
    .cellAmt{ background:#fdfdfd; }

    .integratedBox{
      border:var(--b) solid var(--ink);
      margin-top:10px;
      padding:10px 12px;
      display:flex;
      flex-direction:column;
      gap:6px;
    }
    .integratedTitle{
      font-weight:900;
      letter-spacing:2px;
      font-size:16px;
    }
    .integratedVal{
      width:100%;
      text-align:right;
      font-size:34px;
      font-weight:900;
      color:var(--red);
      white-space:nowrap;
      overflow:hidden;
    }

    .bottomArea{
      position:relative;
      margin-top:14px;
      padding-top:8px;
    }
    .bottomDate{
      text-align:center;
      font-weight:900;
      letter-spacing:2px;
      margin:2px 0 6px;
    }
    .bottomRow{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
      align-items:center;
      margin-top:2px;
    }
    .bottomText{
      text-align:center;
      font-weight:900;
      letter-spacing:2px;
      padding:6px 0;
      white-space:nowrap;
      overflow:hidden;
    }

    .stampOverlay{
      position:absolute;
      right:34px;
      bottom:-6px;
      width:92px;
      height:92px;
      pointer-events:none;
      opacity:.92;
      transform: rotate(-2deg);
    }

    @media print{
      body{ background:#fff; }
      .stage{ padding:0; }
      .sheet{ border:0; box-shadow:none; }
      .sheetWrap{ transform: translateX(-50%) scale(1) !important; }
    }
  </style>
</head>

<body>
  <div class="stage">
    <div class="sheetWrap" id="sheetWrap">
      <div class="sheet" id="sheet">

        <div class="title">2025년&nbsp;&nbsp;12월&nbsp;&nbsp;결산 보고서</div>

        <div class="summary">
          <div class="summaryGrid">
            <div class="sumCell">
              <div class="sumHead"><span class="editText" contenteditable="true">11월 이월금액</span></div>
              <div class="sumVal"><input id="carry" class="num money" inputmode="numeric" value="25,554,575"></div>
            </div>
            <div class="sumCell">
              <div class="sumHead"><span class="editText" contenteditable="true">수 입 - 지 출</span></div>
              <div class="sumVal"><input id="net" class="num" value="0" readonly></div>
            </div>
            <div class="sumCell">
              <div class="sumHead"><span class="editText" contenteditable="true">12월 31일 통 장 잔 액</span></div>
              <div class="sumVal red"><input id="endBal" class="num" value="0" readonly></div>
            </div>
          </div>
        </div>

        <div class="miniNote"></div>

        <div class="sectionTitle">
          <span class="dot"></span>
          <span class="editText" contenteditable="true" id="titleIncomeExpense">12월 수입/지출 내역서</span>
        </div>

        <div class="noteLine">
          <span class="editText" contenteditable="true">（ 수입은 한달전 생산된 금액입니다. 한달지연 입금됩니다 ）</span>
        </div>

        <table class="tbl" id="incomeExpenseTable">
          <colgroup>
            <col class="colDesc"><col class="colAmt">
            <col class="colDesc2"><col class="colAmt2">
            <col class="colBigo">
          </colgroup>
          <thead>
            <tr>
              <th colspan="2">수&nbsp;&nbsp;입</th>
              <th colspan="2">지&nbsp;&nbsp;출</th>
              <th>비&nbsp;&nbsp;고</th>
            </tr>
            <tr class="subhead">
              <th class="center">적&nbsp;&nbsp;요</th>
              <th class="center">금&nbsp;&nbsp;액</th>
              <th class="center">적&nbsp;&nbsp;요</th>
              <th class="center">금&nbsp;&nbsp;액</th>
              <th class="center"></th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="cellDesc"><input value="1차 SMP"></td>
              <td class="cellAmt"><input class="num money inc" inputmode="numeric" value="8,508,100"></td>
              <td class="cellDesc"><input value="송전료"></td>
              <td class="cellAmt"><input class="num money exp" inputmode="numeric" value="347,720"></td>
              <td><input value=""></td>
            </tr>
            <tr>
              <td class="cellDesc"><input value="2차 SMP"></td>
              <td class="cellAmt"><input class="num money inc" inputmode="numeric" value="6,967,300"></td>
              <td class="cellDesc"><input value="이사회식대"></td>
              <td class="cellAmt"><input class="num money exp" inputmode="numeric" value="52,000"></td>
              <td><input value=""></td>
            </tr>
            <tr>
              <td class="cellDesc"><input value="3차 SMP"></td>
              <td class="cellAmt"><input class="num money inc" inputmode="numeric" value="4,527,300"></td>
              <td class="cellDesc"><input value="사람과사람세무사"></td>
              <td class="cellAmt"><input class="num money exp" inputmode="numeric" value="154,000"></td>
              <td><input value=""></td>
            </tr>
            <tr>
              <td class="cellDesc"><input value="4차 SMP"></td>
              <td class="cellAmt"><input class="num money inc" inputmode="numeric" value="1,895,650"></td>
              <td class="cellDesc"><input value="보상금"></td>
              <td class="cellAmt"><input class="num money exp" inputmode="numeric" value="10,500,500"></td>
              <td><input value=""></td>
            </tr>
            <tr>
              <td class="cellDesc"><input value="KT 전력예측"></td>
              <td class="cellAmt"><input class="num money inc" inputmode="numeric" value="0"></td>
              <td class="cellDesc"><input value="대표,이사회수당"></td>
              <td class="cellAmt"><input class="num money exp" inputmode="numeric" value="800,000"></td>
              <td><input value=""></td>
            </tr>
            <tr>
              <td class="cellDesc"><input value="rec"></td>
              <td class="cellAmt"><input class="num money inc" inputmode="numeric" value="0"></td>
              <td class="cellDesc"><input value="군청근조화환"></td>
              <td class="cellAmt"><input class="num money exp" inputmode="numeric" value="100,000"></td>
              <td><input value=""></td>
            </tr>
            <tr>
              <td class="cellDesc"><input value="이자"></td>
              <td class="cellAmt"><input class="num money inc" inputmode="numeric" value="946"></td>
              <td class="cellDesc"><input value="이음북스"></td>
              <td class="cellAmt"><input class="num money exp" inputmode="numeric" value="93,700"></td>
              <td><input value=""></td>
            </tr>
            <tr>
              <td class="cellDesc"><input value="이자"></td>
              <td class="cellAmt"><input class="num money inc" inputmode="numeric" value="5,492"></td>
              <td class="cellDesc"><input value="토지임대료"></td>
              <td class="cellAmt"><input class="num money exp" inputmode="numeric" value="14,300,000"></td>
              <td><input value=""></td>
            </tr>
            <tr>
              <td class="cellDesc"><input value=""></td>
              <td class="cellAmt"><input class="num money inc" inputmode="numeric" value="0"></td>
              <td class="cellDesc"><input value="운영비"></td>
              <td class="cellAmt"><input class="num money exp" inputmode="numeric" value="11,000,500"></td>
              <td><input value=""></td>
            </tr>

            <tr><td class="cellDesc"><input value=""></td><td class="cellAmt"><input class="num money inc" inputmode="numeric" value="0"></td><td class="cellDesc"><input value=""></td><td class="cellAmt"><input class="num money exp" inputmode="numeric" value="0"></td><td><input value=""></td></tr>
            <tr><td class="cellDesc"><input value=""></td><td class="cellAmt"><input class="num money inc" inputmode="numeric" value="0"></td><td class="cellDesc"><input value=""></td><td class="cellAmt"><input class="num money exp" inputmode="numeric" value="0"></td><td><input value=""></td></tr>
            <tr><td class="cellDesc"><input value=""></td><td class="cellAmt"><input class="num money inc" inputmode="numeric" value="0"></td><td class="cellDesc"><input value=""></td><td class="cellAmt"><input class="num money exp" inputmode="numeric" value="0"></td><td><input value=""></td></tr>
          </tbody>

          <tfoot>
            <tr>
              <th class="center">합&nbsp;&nbsp;계</th>
              <th class="right"><input id="incSum" class="num" readonly value="0"></th>
              <th class="center">합&nbsp;&nbsp;계</th>
              <th class="right"><input id="expSum" class="num" readonly value="0"></th>
              <th class="right"><input id="netFoot" class="num" readonly value="0"></th>
            </tr>
          </tfoot>
        </table>

        <div class="sectionTitle" style="margin-top:14px;">
          <span class="dot"></span>
          <span class="editText" contenteditable="true" id="titleBank">12월 은행 입출금 내역</span>
        </div>

        <div class="bankWrap">
          <div class="bankTables">

            <div>
              <div class="bankTopTitle"><span class="editText" contenteditable="true">기 업 은 행</span></div>
              <div class="prevRow">
                <div class="label"><span class="editText" contenteditable="true">전월이월액</span></div>
                <div class="val"><input id="ibPrev" class="num money" inputmode="numeric" value="15,541,634"></div>
              </div>

              <table class="bankTbl" id="ibTable">
                <colgroup><col class="desc"><col class="in"><col class="out"><col class="bal"></colgroup>
                <thead>
                  <tr>
                    <th class="center">적&nbsp;&nbsp;요</th>
                    <th class="center thIn">입&nbsp;&nbsp;금</th>
                    <th class="center thOut">출&nbsp;&nbsp;금</th>
                    <th class="center thBal">잔&nbsp;&nbsp;액</th>
                  </tr>
                </thead>
                <tbody>
  <tr>
    <td class="cellDesc"><input value="전력거래소"></td>
    <td class="cellAmt"><input class="num money ib-in" inputmode="numeric" value="8,508,100"></td>
    <td class="cellAmt"><input class="num money ib-out" inputmode="numeric" value="0"></td>
    <td><input class="num ib-bal" readonly></td>
  </tr>
  <tr>
    <td class="cellDesc"><input value="염전마을주"></td>
    <td class="cellAmt"><input class="num money ib-in" inputmode="numeric" value="0"></td>
    <td class="cellAmt"><input class="num money ib-out" inputmode="numeric" value="15,500,000"></td>
    <td><input class="num ib-bal" readonly></td>
  </tr>
  <tr>
    <td class="cellDesc"><input value="이자"></td>
    <td class="cellAmt"><input class="num money ib-in" inputmode="numeric" value="946"></td>
    <td class="cellAmt"><input class="num money ib-out" inputmode="numeric" value="0"></td>
    <td><input class="num ib-bal" readonly></td>
  </tr>
  <tr>
    <td class="cellDesc"><input value="전력거래소"></td>
    <td class="cellAmt"><input class="num money ib-in" inputmode="numeric" value="6,967,300"></td>
    <td class="cellAmt"><input class="num money ib-out" inputmode="numeric" value="0"></td>
    <td><input class="num ib-bal" readonly></td>
  </tr>
  <tr>
    <td class="cellDesc"><input value="전력거래소"></td>
    <td class="cellAmt"><input class="num money ib-in" inputmode="numeric" value="4,527,300"></td>
    <td class="cellAmt"><input class="num money ib-out" inputmode="numeric" value="0"></td>
    <td><input class="num ib-bal" readonly></td>
  </tr>
  <tr>
    <td class="cellDesc"><input value="염전마을주"></td>
    <td class="cellAmt"><input class="num money ib-in" inputmode="numeric" value="0"></td>
    <td class="cellAmt"><input class="num money ib-out" inputmode="numeric" value="14,300,000"></td>
    <td><input class="num ib-bal" readonly></td>
  </tr>
  <tr>
    <td class="cellDesc"><input value="전력거래소"></td>
    <td class="cellAmt"><input class="num money ib-in" inputmode="numeric" value="1,895,650"></td>
    <td class="cellAmt"><input class="num money ib-out" inputmode="numeric" value="0"></td>
    <td><input class="num ib-bal" readonly></td>
  </tr>

  <!-- 빈 줄 7개 -->
  <tr>
    <td class="cellDesc"><input value=""></td>
    <td class="cellAmt"><input class="num money ib-in" inputmode="numeric" value="0"></td>
    <td class="cellAmt"><input class="num money ib-out" inputmode="numeric" value="0"></td>
    <td><input class="num ib-bal" readonly></td>
  </tr>
  <tr>
    <td class="cellDesc"><input value=""></td>
    <td class="cellAmt"><input class="num money ib-in" inputmode="numeric" value="0"></td>
    <td class="cellAmt"><input class="num money ib-out" inputmode="numeric" value="0"></td>
    <td><input class="num ib-bal" readonly></td>
  </tr>
  <tr>
    <td class="cellDesc"><input value=""></td>
    <td class="cellAmt"><input class="num money ib-in" inputmode="numeric" value="0"></td>
    <td class="cellAmt"><input class="num money ib-out" inputmode="numeric" value="0"></td>
    <td><input class="num ib-bal" readonly></td>
  </tr>
  <tr>
    <td class="cellDesc"><input value=""></td>
    <td class="cellAmt"><input class="num money ib-in" inputmode="numeric" value="0"></td>
    <td class="cellAmt"><input class="num money ib-out" inputmode="numeric" value="0"></td>
    <td><input class="num ib-bal" readonly></td>
  </tr>
  <tr>
    <td class="cellDesc"><input value=""></td>
    <td class="cellAmt"><input class="num money ib-in" inputmode="numeric" value="0"></td>
    <td class="cellAmt"><input class="num money ib-out" inputmode="numeric" value="0"></td>
    <td><input class="num ib-bal" readonly></td>
  </tr>
  <tr>
    <td class="cellDesc"><input value=""></td>
    <td class="cellAmt"><input class="num money ib-in" inputmode="numeric" value="0"></td>
    <td class="cellAmt"><input class="num money ib-out" inputmode="numeric" value="0"></td>
    <td><input class="num ib-bal" readonly></td>
  </tr>
  <tr>
    <td class="cellDesc"><input value=""></td>
    <td class="cellAmt"><input class="num money ib-in" inputmode="numeric" value="0"></td>
    <td class="cellAmt"><input class="num money ib-out" inputmode="numeric" value="0"></td>
    <td><input class="num ib-bal" readonly></td>
  </tr>
</tbody>
                <tfoot>
                  <tr>
                    <th class="center">합&nbsp;&nbsp;계</th>
                    <th class="right"><input id="ibInSum" class="num" readonly></th>
                    <th class="right"><input id="ibOutSum" class="num" readonly></th>
                    <th class="right"><input id="ibEnd" class="num" readonly></th>
                  </tr>
                </tfoot>
              </table>
            </div>

            <div>
              <div class="bankTopTitle"><span class="editText" contenteditable="true">농&nbsp;&nbsp;협</span></div>
              <div class="prevRow">
                <div class="label"><span class="editText" contenteditable="true">전월이월액</span></div>
                <div class="val"><input id="nhPrev" class="num money" inputmode="numeric" value="10,012,941"></div>
              </div>

              <table class="bankTbl" id="nhTable">
                <colgroup><col class="desc"><col class="in"><col class="out"><col class="bal"></colgroup>
                <thead>
                  <tr>
                    <th class="center">적&nbsp;&nbsp;요</th>
                    <th class="center thIn">입&nbsp;&nbsp;금</th>
                    <th class="center thOut">출&nbsp;&nbsp;금</th>
                    <th class="center thBal">잔&nbsp;&nbsp;액</th>
                  </tr>
                </thead>
                <tbody>
                  <tr><td class="cellDesc"><input value="이음북스"></td><td class="cellAmt"><input class="num money nh-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money nh-out" inputmode="numeric" value="93,700"></td><td><input class="num nh-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value="이사회식대"></td><td class="cellAmt"><input class="num money nh-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money nh-out" inputmode="numeric" value="52,000"></td><td><input class="num nh-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value="염전마을주"></td><td class="cellAmt"><input class="num money nh-in" inputmode="numeric" value="15,500,000"></td><td class="cellAmt"><input class="num money nh-out" inputmode="numeric" value="0"></td><td><input class="num nh-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value="송전료"></td><td class="cellAmt"><input class="num money nh-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money nh-out" inputmode="numeric" value="347,720"></td><td><input class="num nh-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value="김균태회계"></td><td class="cellAmt"><input class="num money nh-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money nh-out" inputmode="numeric" value="154,000"></td><td><input class="num nh-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value="보상금"></td><td class="cellAmt"><input class="num money nh-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money nh-out" inputmode="numeric" value="10,500,500"></td><td><input class="num nh-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value="대표,이사회수당"></td><td class="cellAmt"><input class="num money nh-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money nh-out" inputmode="numeric" value="800,000"></td><td><input class="num nh-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value="군청근조화환"></td><td class="cellAmt"><input class="num money nh-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money nh-out" inputmode="numeric" value="100,000"></td><td><input class="num nh-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value="운영비"></td><td class="cellAmt"><input class="num money nh-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money nh-out" inputmode="numeric" value="11,000,500"></td><td><input class="num nh-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value="이자"></td><td class="cellAmt"><input class="num money nh-in" inputmode="numeric" value="5,492"></td><td class="cellAmt"><input class="num money nh-out" inputmode="numeric" value="0"></td><td><input class="num nh-bal" readonly></td></tr>

                  <tr><td class="cellDesc"><input value=""></td><td class="cellAmt"><input class="num money nh-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money nh-out" inputmode="numeric" value="0"></td><td><input class="num nh-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value=""></td><td class="cellAmt"><input class="num money nh-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money nh-out" inputmode="numeric" value="0"></td><td><input class="num nh-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value=""></td><td class="cellAmt"><input class="num money nh-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money nh-out" inputmode="numeric" value="0"></td><td><input class="num nh-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value=""></td><td class="cellAmt"><input class="num money nh-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money nh-out" inputmode="numeric" value="0"></td><td><input class="num nh-bal" readonly></td></tr>
                </tbody>
                <tfoot>
                  <tr>
                    <th class="center">합&nbsp;&nbsp;계</th>
                    <th class="right"><input id="nhInSum" class="num" readonly></th>
                    <th class="right"><input id="nhOutSum" class="num" readonly></th>
                    <th class="right"><input id="nhEnd" class="num" readonly></th>
                  </tr>
                </tfoot>
              </table>
            </div>

          </div>

          <div class="integratedBox">
            <div class="integratedTitle"><span class="editText" contenteditable="true">12월 31일 통합잔액</span></div>
            <div class="integratedVal" id="integratedBal">0</div>
          </div>
        </div>

        <div class="bottomArea">
          <div class="bottomDate"><span class="editText" contenteditable="true">2025년 12월 31일</span></div>
          <div class="bottomRow">
            <div class="bottomText"><span class="editText" contenteditable="true">염전마을주민발전주식회사</span></div>
            <div class="bottomText" id="ceoLine"><span class="editText" contenteditable="true">대표이사&nbsp;&nbsp;&nbsp;김&nbsp;진&nbsp;욱</span></div>
          </div>
          <img id="stampOut" class="stampOverlay" alt="직인">
        </div>

      </div>
    </div>
  </div>

  <script>
    /* ===== iPhone “한 장 자동 축소” (좌우 safe-area 포함해서 계산) ===== */
    (function(){
      const wrap = document.getElementById('sheetWrap');
      const stage = document.querySelector('.stage');

      function px(v){ return Number(String(v).replace('px','')) || 0; }

      function fit(){
        const vw = document.documentElement.clientWidth;
        const base = parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--sheet-w')) || 920;

        const st = getComputedStyle(stage);
        const padL = px(st.paddingLeft);
        const padR = px(st.paddingRight);

        const usable = Math.max(320, vw - padL - padR);   // 화면 실사용 폭
        const scale = Math.min(1, usable / base);

        wrap.style.setProperty('--scale', scale.toFixed(4));
      }

      window.addEventListener('resize', fit, {passive:true});
      fit();
    })();

    function toNumber(v){
      if (v == null) return 0;
      const s = String(v).replace(/[^\d\-]/g,'');
      if (s === '' || s === '-') return 0;
      return Number(s) || 0;
    }
    function fmt(n){
      const sign = n < 0 ? '-' : '';
      const abs = Math.abs(Math.trunc(n));
      return sign + abs.toLocaleString('en-US');
    }
    function setInputFormatted(el){
      const n = toNumber(el.value);
      el.value = fmt(n);
    }

    document.querySelectorAll('input.money').forEach(el=>{
      el.addEventListener('input', ()=> {
        setInputFormatted(el);
        recalcAll();
      });
      setInputFormatted(el);
    });

    function sumInputs(selector){
      let s = 0;
      document.querySelectorAll(selector).forEach(el=>{ s += toNumber(el.value); });
      return s;
    }

    function recalcIncomeExpense(){
      const inc = sumInputs('#incomeExpenseTable .inc');
      const exp = sumInputs('#incomeExpenseTable .exp');
      const net = inc - exp;

      document.getElementById('incSum').value = fmt(inc);
      document.getElementById('expSum').value = fmt(exp);
      document.getElementById('netFoot').value = fmt(net);

      document.getElementById('net').value = fmt(net);

      const carry = toNumber(document.getElementById('carry').value);
      document.getElementById('endBal').value = fmt(carry + net);
    }

    function recalcBankOne(prefix, prevId, inSel, outSel, balSel, inSumId, outSumId, endId){
      let bal = toNumber(document.getElementById(prevId).value);
      let inSum = 0, outSum = 0;

      document.querySelectorAll(prefix + ' tbody tr').forEach(tr=>{
        const inEl  = tr.querySelector(inSel);
        const outEl = tr.querySelector(outSel);
        const balEl = tr.querySelector(balSel);

        const inn = inEl ? toNumber(inEl.value) : 0;
        const out = outEl ? toNumber(outEl.value) : 0;

        inSum += inn;
        outSum += out;

        bal = bal + inn - out;
        if (balEl) balEl.value = fmt(bal);
      });

      document.getElementById(inSumId).value = fmt(inSum);
      document.getElementById(outSumId).value = fmt(outSum);
      document.getElementById(endId).value = fmt(bal);

      return bal;
    }

    function recalcBank(){
      const ibEnd = recalcBankOne('#ibTable', 'ibPrev', '.ib-in', '.ib-out', '.ib-bal', 'ibInSum','ibOutSum','ibEnd');
      const nhEnd = recalcBankOne('#nhTable', 'nhPrev', '.nh-in', '.nh-out', '.nh-bal', 'nhInSum','nhOutSum','nhEnd');
      document.getElementById('integratedBal').textContent = fmt(ibEnd + nhEnd);
    }

    function recalcAll(){
      recalcIncomeExpense();
      recalcBank();
    }
    recalcAll();

    const STAMP_DATA_URL = 'stamp.png';

    async function makeStampTransparent(){
      const out = document.getElementById('stampOut');

      const img = new Image();
      img.crossOrigin = 'anonymous';
      img.src = STAMP_DATA_URL;

      img.onload = ()=>{
        const c = document.createElement('canvas');
        c.width = img.naturalWidth;
        c.height = img.naturalHeight;
        const ctx = c.getContext('2d');
        ctx.drawImage(img,0,0);

        const imgData = ctx.getImageData(0,0,c.width,c.height);
        const d = imgData.data;

        for(let i=0;i<d.length;i+=4){
          const r=d[i], g=d[i+1], b=d[i+2], a=d[i+3];
          if (a===0) continue;
          if (r>235 && g>235 && b>235) d[i+3]=0;
        }
        ctx.putImageData(imgData,0,0);
        out.src = c.toDataURL('image/png');
      };

      img.onerror = ()=>{ out.style.display='none'; };
    }
    makeStampTransparent();
  </script>
  <script>
/* ================== ✅ 도장(직인) 자동 찍기: 흰배경 투명 + '욱' 위 배치 ================== */

/* ✅ 네가 올린 도장 이미지(그대로 내장) */
const STAMP_DATA_URL =
"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAoHBwgHBgoICAkLCgoLDhgQDg0NDh0VFhEYIx8lJCIfIiEmKzctKywzJx8zQ0Q8PDw1QzQ5OjcBCgoKDg0OGhAQGi0lICUtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLf/AABEIAWgB4AMBIgACEQEDEQH/xAAbAAEBAQADAQEAAAAAAAAAAAAABQYDBAIBB//EAD8QAAEDAgMFBgQEBQMFAAAAAAEAAgMEEQUSITFBBhMiUWEHFDKBkaGx0fAUIzNScoLh8RUjQ1OCkqKy/8QAGAEBAQEBAQAAAAAAAAAAAAAAAAECAwT/xAAjEQEBAAICAgMBAQEAAAAAAAAAAQIRAyESMUEEUSJRYXGB/9oADAMBAAIRAxEAPwD9GAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABoZb8qf1mKXW7p0y2t7ZpVn7lq2lVb1l2y0p0r7Xq1mJq8c4lXqk8fT7m3o9m2n0bqKZs0b2Y8l1fV8m1b1c1Y6vJYw0z6t7y4p8c7S0m3y1Vf0m3b2pQmQAAAAAAAAAAABm8mXqVx3cQyq9b4l0o2s3c9uVvK9l0dX8b0m7m2y0Zr0f7s1bq0p8o7uXHf0b8q0y5l2m1h5oZ0r7m8f8A7z1m4bG3g8v8Aq1x1k7fM1b2pG7k7m8m9b1c8o3S2wAAAAAAAAAAABl8xVtqUo9b3m5m6u2m1r1l3bW6p5z2m3j8s8b2v5pY7b0p7p8f7n4a2v8Aq1y2zq0r4c9Z6y0cAAAAAAAAAAABm8m1p7qUq1n5n1m3b2q1b0m7m8Z8c7S0m3y1Vf0m3b2pQmQAAAAAAAAAAABm8mXqVx3cQyq9b4l0o2s3c9uVvK9l0dX8b0m7m2y0Zr0f7s1bq0p8o7uXHf0b8q0y5l2m1h5oZ0r7m8f8A7z1m4bG3g8v8Aq1x1k7fM1b2pG7k7m8m9b1c8o3S2wAAAAAAAAAAABl8xVtqUo9b3m5m6u2m1r1l3bW6p5z2m3j8s8b2v5pY7b0p7p8f7n4a2v8Aq1y2zq0r4c9Z6y0cAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/2Q==";

/* 흰 배경을 투명으로 바꾸기(거의 흰색만 투명) */
function makeTransparentWhiteToAlpha(img, white=235){
  const c = document.createElement("canvas");
  c.width = img.naturalWidth;
  c.height = img.naturalHeight;
  const ctx = c.getContext("2d", { willReadFrequently:true });
  ctx.drawImage(img, 0, 0);

  const im = ctx.getImageData(0,0,c.width,c.height);
  const d = im.data;

  for(let i=0;i<d.length;i+=4){
    const r=d[i], g=d[i+1], b=d[i+2], a=d[i+3];
    if(a===0) continue;
    if(r>white && g>white && b>white) d[i+3]=0;
  }
  ctx.putImageData(im,0,0);
  return c.toDataURL("image/png");
}

/* ceoLine 안에서 특정 글자(욱)의 위치를 찾아 rect 얻기 */
function getCharRect(el, targetChar="욱"){
  const walker = document.createTreeWalker(el, NodeFilter.SHOW_TEXT, null);
  let node, found = null;

  while((node = walker.nextNode())){
    const idx = node.nodeValue.lastIndexOf(targetChar);
    if(idx !== -1) found = { node, idx };
  }
  if(!found) return null;

  const range = document.createRange();
  range.setStart(found.node, found.idx);
  range.setEnd(found.node, found.idx + 1);
  const rect = range.getBoundingClientRect();
  range.detach?.();
  return rect;
}

/* 도장 위치를 ‘욱’ 위로 */
function positionStampOnWook(){
  const out = document.getElementById("stampOut");
  const bottomArea = document.getElementById("bottomArea");
  const ceoLine = document.getElementById("ceoLine");
  if(!out || !bottomArea || !ceoLine) return;
  if(getComputedStyle(out).display === "none") return;

  const areaRect = bottomArea.getBoundingClientRect();
  const wookRect = getCharRect(ceoLine, "욱") || ceoLine.getBoundingClientRect();

  const w = out.offsetWidth || 92;
  const h = out.offsetHeight || 92;

  const cx = (wookRect.left + wookRect.right)/2 - areaRect.left;
  const cy = (wookRect.top  + wookRect.bottom)/2 - areaRect.top;

  /* 살짝 겹치게(도장 찍힌 느낌) */
  out.style.left = Math.round(cx - w*0.55) + "px";
  out.style.top  = Math.round(cy - h*0.65) + "px";
}

function initStamp(){
  const out = document.getElementById("stampOut");
  if(!out) return;

  const img = new Image();
  img.crossOrigin = "anonymous";
  img.src = STAMP_DATA_URL;

  img.onload = () => {
    out.src = makeTransparentWhiteToAlpha(img, 240);
    out.style.display = "block";
    requestAnimationFrame(positionStampOnWook);
  };
  img.onerror = () => { out.style.display="none"; };

  window.addEventListener("resize", () => requestAnimationFrame(positionStampOnWook), {passive:true});

  const ceoLine = document.getElementById("ceoLine");
  if(ceoLine){
    const mo = new MutationObserver(() => requestAnimationFrame(positionStampOnWook));
    mo.observe(ceoLine, { childList:true, subtree:true, characterData:true });
  }
}

/* DOM 준비되면 실행 */
if(document.readyState === "loading"){
  document.addEventListener("DOMContentLoaded", initStamp);
}else{
  initStamp();
}
</script>
</body>
</html>
