<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>2025년 12월 결산 보고서</title>
  <style>
    :root{
      --ink:#111;
      --grid:#222;
      --muted:#666;
      --red:#d82222;

      --sheet-w: 920px;
      --pad: 18px;
      --b: 3px;
      --b2: 2px;
      --font: "Apple SD Gothic Neo","Noto Sans KR",system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;

      /* 은행표 헤더만 은은하게(요구한 “한 줄만” 느낌) */
      --c-in:  #dfe8f6;
      --c-out: #f6ddcf;
      --c-bal: #d7f1ea;
    }

    *{ box-sizing:border-box; }
    html, body{
      margin:0;
      padding:0;
      background:#f3f4f6;
      font-family:var(--font);
      color:var(--ink);
      width:100%;
      overflow-x:hidden;
      -webkit-text-size-adjust:100%;
      text-size-adjust:100%;
    }

    .stage{
      width:100%;
      padding-top:14px;
      padding-bottom:40px;
      padding-left:calc(10px + env(safe-area-inset-left));
      padding-right:calc(10px + env(safe-area-inset-right));
      overflow-x:hidden;
      position:relative;
    }

    .sheetWrap{
      width:var(--sheet-w);
      position:relative;
      left:50%;
      transform-origin: top center;
      transform: translateX(-50%) scale(var(--scale, 1));
      will-change: transform;
      backface-visibility:hidden;
      -webkit-font-smoothing: antialiased;
    }

    .sheet{
      width:var(--sheet-w);
      background:#fff;
      border:1px solid #d5d7db;
      box-shadow:0 8px 28px rgba(0,0,0,.08);
      padding:var(--pad);
    }

    input{
      width:100%;
      min-width:0;
      max-width:100%;
      border:0;
      outline:0;
      background:transparent;
      font:inherit;
      color:inherit;
      padding:0;
      margin:0;
      display:block;
      -webkit-appearance:none;
      appearance:none;
      border-radius:0;
    }
    .num{
      text-align:right;
      white-space:nowrap;
      font-variant-numeric: tabular-nums;
    }

    table{
      width:100%;
      border-collapse:collapse;
      table-layout:fixed;
    }
    th, td{
      overflow:hidden;
      white-space:nowrap;
      text-overflow:clip;
      vertical-align:middle;
      min-width:0;
    }

    /* =========================
       제목(수정 가능 + 점선 제거)
       ========================= */
    .titleWrap{
      margin:6px 0 14px;
      padding:14px 10px 12px;
      position:relative;
    }
    .titleLineTop,
    .titleLineBot{
      height:6px;
      background:linear-gradient(90deg, #9cff4a 0 44%, #6fdc33 44% 46%, #78e63a 46% 100%);
      border-radius:3px;
    }
    .titleLineTop{ margin:0 0 14px; }
    .titleLineBot{ margin:14px 0 0; background:linear-gradient(90deg, #2f7f2b 0 50%, #5fdd33 50% 52%, #2f7f2b 52% 100%); }

    .titleBox{
      border:0;
      padding:10px 14px;
      display:flex;
      justify-content:center;
      align-items:center;
      background:#fff;
    }
    .titleText{
      font-weight:1000;
      -webkit-text-stroke: 1px rgba(0,0,0,.25);
      font-size:56px;
      letter-spacing:-1px;
      line-height:1.02;
      color:#143a63;
      text-shadow: 4px 4px 0 rgba(0,0,0,.18);
      white-space:nowrap;
    }

    .summary{
      border:var(--b) solid var(--ink);
      margin:6px 0 12px;
    }
    .summaryGrid{
      display:grid;
      grid-template-columns: 1fr 1fr 1fr;
    }
    .sumCell{ border-right:var(--b) solid var(--ink); }
    .sumCell:last-child{ border-right:0; }
    .sumHead{
      border-bottom:var(--b) solid var(--ink);
      text-align:center;
      font-size:20px;
      padding:10px 8px;
      letter-spacing:2px;
      font-weight:900;
      background:#fff; /* ✅ 배경색 제거 */
    }
    .sumVal{
      text-align:center;
      font-weight:900;
      font-size:34px;
      padding:14px 10px;
      background:#fff; /* ✅ 배경색 제거 */
    }
    .sumVal.red{ color:var(--red); }
    .sumVal input{
      text-align:center;
      font-weight:900;
      font-size:34px;
    }
    .sumVal.red input{ color:var(--red); }

    .miniNote{ display:none; }

    .sectionTitle{
      display:flex;
      align-items:center;
      gap:10px;
      margin:10px 0 8px;
      font-weight:900;
      font-size:22px;
    }
    .dot{
      width:18px; height:18px;
      border:2px solid var(--ink);
      border-radius:50%;
      flex:0 0 auto;
    }

    .editText{
      display:inline-block;
      min-width:10px;
      outline:none;
      cursor:text;
    }

    .tbl{
      border:var(--b) solid var(--ink);
    }
    .tbl th, .tbl td{
      border:var(--b2) solid var(--grid);
      padding:6px 8px;
      font-size:16px;
    }
    .tbl th{
      background:#f2f2f2;
      text-align:center;
      font-weight:900;
      letter-spacing:2px;
    }
    .tbl .subhead th{
      background:#f7f7f7;
      letter-spacing:1px;
    }
    .center{ text-align:center; }
    .right{ text-align:right; }
    .bold{ font-weight:900; }

    .noteLine{
      border:var(--b) solid var(--ink);
      padding:8px 10px;
      margin:-2px 0 8px;
      font-size:14px;
      color:#222;
      text-align:center;
      font-weight:800;
    }

    .colDesc{ width:28%; }
    .colAmt{ width:16%; }
    .colDesc2{ width:28%; }
    .colAmt2{ width:16%; }
    .colBigo{ width:12%; }

    .bankWrap{
      border:var(--b) solid var(--ink);
      padding:10px;
    }
    .bankTables{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
    }
    .bankTbl{
      border:var(--b) solid var(--ink);
    }
    .bankTbl th, .bankTbl td{
      border:var(--b2) solid var(--grid);
      padding:6px 6px;
      font-size:14px;
    }
    .bankTopTitle{
      border-bottom:var(--b2) solid var(--grid);
      font-weight:900;
      text-align:center;
      letter-spacing:4px;
      padding:6px 0;
      background:#fff;
    }

    .prevRow{
      display:grid;
      grid-template-columns: 140px 1fr;
      border-bottom:var(--b2) solid var(--grid);
    }
    .prevRow .label{
      background:#f7f7f7;
      border-right:var(--b2) solid var(--grid);
      text-align:center;
      font-weight:900;
      letter-spacing:2px;
      padding:8px 8px;
    }
    .prevRow .val{
      padding:8px 8px;
      font-weight:900;
      text-align:right;
      min-width:0;
    }

    .bankTbl col.desc{ width:28%; }
    .bankTbl col.in{ width:24%; }
    .bankTbl col.out{ width:24%; }
    .bankTbl col.bal{ width:24%; }

    .bankTbl th{ background:#f2f2f2; text-align:center; font-weight:900; }

    /* ✅ 은행 “한 줄만” 색: 헤더의 입금/출금/잔액 칸만 */
    .thIn{ background:var(--c-in) !important; }
    .thOut{ background:var(--c-out) !important; }
    .thBal{ background:var(--c-bal) !important; }

    .cellDesc{ background:#fbfbfb; }
    .cellAmt{ background:#fdfdfd; }

    /* =========================
       하단: 통합잔액(그냥 전체 숫자)
       - 라벨 없음
       - 날짜/회사+대표 2줄 박스 안
       ========================= */
    .integratedBox{
      border:var(--b) solid var(--ink);
      margin-top:10px;
      padding:12px 12px 14px;
      display:flex;
      flex-direction:column;
      gap:10px;
      position:relative;
      min-height:150px;
    }

    .integratedVal{
      width:100%;
      text-align:right;
      font-size:34px;
      font-weight:900;
      color:var(--red);
      white-space:nowrap;
      overflow:hidden;
      line-height:1.05;
    }

    .integratedMeta{
      display:flex;
      flex-direction:column;
      gap:6px;
      padding-top:2px;
    }
    .metaLine1,
    .metaLine2{
      text-align:center;
      font-weight:900;
      color:#143a63;
      text-shadow: 2px 2px 0 rgba(0,0,0,.14);
      letter-spacing:-0.5px;
      font-size:30px;
      line-height:1.02;
      white-space:nowrap;
    }

    .stampOverlay{
      position:absolute;
      right:18px;
      bottom:10px;
      width:92px;
      height:92px;
      pointer-events:none;
      opacity:.92;
      transform: rotate(-2deg);
      display:none;
      z-index:5;
    }

    @media print{
      body{ background:#fff; }
      .stage{ padding:0; }
      .sheet{ border:0; box-shadow:none; }
      .sheetWrap{ transform: translateX(-50%) scale(1) !important; }
    }

    /* ===== 상단 요약 3칸 : 헤더 한 줄만 색 ===== */
    .sumCell:nth-child(1) .sumHead{ background:#e8f0fb !important; }
    .sumCell:nth-child(2) .sumHead{ background:#fde9d9 !important; }
    .sumCell:nth-child(3) .sumHead{ background:#e6f6f2 !important; }

    /* ===== 수입/지출: '적요/금액' 헤더 한 줄만 색 ===== */
    #incomeExpenseTable thead tr.subhead th:nth-child(1),
    #incomeExpenseTable thead tr.subhead th:nth-child(2){ background:#e8f0fb !important; }
    #incomeExpenseTable thead tr.subhead th:nth-child(3),
    #incomeExpenseTable thead tr.subhead th:nth-child(4){ background:#fde9d9 !important; }

    /* (중요) 본문칸은 기존 cellDesc/cellAmt 색이 있으면 제거 */
    #incomeExpenseTable tbody td.cellDesc,
    #incomeExpenseTable tbody td.cellAmt{ background:#fff !important; }

    /* ===== 모든 금액 숫자 오른쪽 끝 정렬 ===== */
    input.num, input.money{ text-align:right !important; padding-right:0 !important; }
    .sumVal, .sumVal input{ text-align:right !important; padding-right:12px !important; }

    #incomeExpenseTable td:nth-child(2),
    #incomeExpenseTable td:nth-child(4),
    #incomeExpenseTable td:nth-child(2) input,
    #incomeExpenseTable td:nth-child(4) input{
      text-align:right !important; padding-right:8px !important;
    }

    .bankTbl td,
    .bankTbl td input{ text-align:right !important; padding-right:6px !important; }

    #incSum,#expSum,#net,#netFoot,#endBal,#ibInSum,#ibOutSum,#ibEnd,#nhInSum,#nhOutSum,#nhEnd{
      text-align:right !important; padding-right:6px !important;
    }

    /* 도장 */
    .ceoStamp{ height:34px; margin-left:10px; vertical-align:middle; opacity:0.9; }
    .nameLast{ position:relative; display:inline-block; z-index:2; }
    .ceoStampBig{
      position:absolute;
      width:90px;
      height:90px;
      left:50%;
      top:50%;
      transform:translate(-50%, -50%);
      opacity:0.9;
      pointer-events:none;
      z-index:1;
    }
    .signLine{
      font-weight:900;
      font-size:30px;
      color:#143a63;
      letter-spacing:-0.5px;
      line-height:1.02;
      white-space:nowrap;
    }
  </style>
</head>
   <body>
    <div class="stage">
    <div class="sheetWrap" id="sheetWrap">
      <div class="sheet" id="sheet">

        <div class="titleWrap">
          <div class="titleLineTop"></div>
          <div class="titleBox">
            <div class="titleText editText" contenteditable="true">2025년&nbsp;&nbsp;12월&nbsp;&nbsp;결산&nbsp;&nbsp;보고서</div>
          </div>
          <div class="titleLineBot"></div>
        </div>

        <div class="summary">
          <div class="summaryGrid">
            <div class="sumCell">
              <div class="sumHead"><span class="editText" contenteditable="true">11월 이월금액</span></div>
              <div class="sumVal"><input id="carry" class="num money" inputmode="numeric" value="25,554,575"></div>
            </div>
            <div class="sumCell">
              <div class="sumHead"><span class="editText" contenteditable="true">수 입 - 지 출</span></div>
              <div class="sumVal"><input id="net" class="num" value="0" readonly></div>
            </div>
            <div class="sumCell">
              <div class="sumHead"><span class="editText" contenteditable="true">12월 31일 통 장 잔 액</span></div>
              <div class="sumVal red"><input id="endBal" class="num" value="0" readonly></div>
            </div>
          </div>
        </div>

        <div class="miniNote"></div>

        <div class="sectionTitle">
          <span class="dot"></span>
          <span class="editText" contenteditable="true" id="titleIncomeExpense">12월 수입/지출 내역서</span>
        </div>

        <div class="noteLine">
          <span class="editText" contenteditable="true">（ 수입은 한달전 생산된 금액입니다. 한달지연 입금됩니다 ）</span>
        </div>

        <table class="tbl" id="incomeExpenseTable">
          <colgroup>
            <col class="colDesc"><col class="colAmt">
            <col class="colDesc2"><col class="colAmt2">
            <col class="colBigo">
          </colgroup>
          <thead>
            <tr>
              <th colspan="2">수&nbsp;&nbsp;입</th>
              <th colspan="2">지&nbsp;&nbsp;출</th>
              <th>비&nbsp;&nbsp;고</th>
            </tr>
            <tr class="subhead">
              <th class="center">적&nbsp;&nbsp;요</th>
              <th class="center">금&nbsp;&nbsp;액</th>
              <th class="center">적&nbsp;&nbsp;요</th>
              <th class="center">금&nbsp;&nbsp;액</th>
              <th class="center"></th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="cellDesc"><input value="1차 SMP"></td>
              <td class="cellAmt"><input class="num money inc" inputmode="numeric" value="8,508,100"></td>
              <td class="cellDesc"><input value="송전료"></td>
              <td class="cellAmt"><input class="num money exp" inputmode="numeric" value="347,720"></td>
              <td><input value=""></td>
            </tr>
            <tr>
              <td class="cellDesc"><input value="2차 SMP"></td>
              <td class="cellAmt"><input class="num money inc" inputmode="numeric" value="6,967,300"></td>
              <td class="cellDesc"><input value="이사회식대"></td>
              <td class="cellAmt"><input class="num money exp" inputmode="numeric" value="52,000"></td>
              <td><input value=""></td>
            </tr>
            <tr>
              <td class="cellDesc"><input value="3차 SMP"></td>
              <td class="cellAmt"><input class="num money inc" inputmode="numeric" value="4,527,300"></td>
              <td class="cellDesc"><input value="사람과사람세무사"></td>
              <td class="cellAmt"><input class="num money exp" inputmode="numeric" value="154,000"></td>
              <td><input value=""></td>
            </tr>
            <tr>
              <td class="cellDesc"><input value="4차 SMP"></td>
              <td class="cellAmt"><input class="num money inc" inputmode="numeric" value="1,895,650"></td>
              <td class="cellDesc"><input value="보상금"></td>
              <td class="cellAmt"><input class="num money exp" inputmode="numeric" value="10,500,500"></td>
              <td><input value=""></td>
            </tr>
            <tr>
              <td class="cellDesc"><input value="KT 전력예측"></td>
              <td class="cellAmt"><input class="num money inc" inputmode="numeric" value="0"></td>
              <td class="cellDesc"><input value="대표,이사회수당"></td>
              <td class="cellAmt"><input class="num money exp" inputmode="numeric" value="800,000"></td>
              <td><input value=""></td>
            </tr>
            <tr>
              <td class="cellDesc"><input value="rec"></td>
              <td class="cellAmt"><input class="num money inc" inputmode="numeric" value="0"></td>
              <td class="cellDesc"><input value="군청근조화환"></td>
              <td class="cellAmt"><input class="num money exp" inputmode="numeric" value="100,000"></td>
              <td><input value=""></td>
            </tr>
            <tr>
              <td class="cellDesc"><input value="이자"></td>
              <td class="cellAmt"><input class="num money inc" inputmode="numeric" value="946"></td>
              <td class="cellDesc"><input value="이음북스"></td>
              <td class="cellAmt"><input class="num money exp" inputmode="numeric" value="93,700"></td>
              <td><input value=""></td>
            </tr>
            <tr>
              <td class="cellDesc"><input value="이자"></td>
              <td class="cellAmt"><input class="num money inc" inputmode="numeric" value="5,492"></td>
              <td class="cellDesc"><input value="토지임대료"></td>
              <td class="cellAmt"><input class="num money exp" inputmode="numeric" value="14,300,000"></td>
              <td><input value=""></td>
            </tr>
            <tr>
              <td class="cellDesc"><input value=""></td>
              <td class="cellAmt"><input class="num money inc" inputmode="numeric" value="0"></td>
              <td class="cellDesc"><input value="운영비"></td>
              <td class="cellAmt"><input class="num money exp" inputmode="numeric" value="11,000,500"></td>
              <td><input value=""></td>
            </tr>

            <tr><td class="cellDesc"><input value=""></td><td class="cellAmt"><input class="num money inc" inputmode="numeric" value="0"></td><td class="cellDesc"><input value=""></td><td class="cellAmt"><input class="num money exp" inputmode="numeric" value="0"></td><td><input value=""></td></tr>
            <tr><td class="cellDesc"><input value=""></td><td class="cellAmt"><input class="num money inc" inputmode="numeric" value="0"></td><td class="cellDesc"><input value=""></td><td class="cellAmt"><input class="num money exp" inputmode="numeric" value="0"></td><td><input value=""></td></tr>
            <tr><td class="cellDesc"><input value=""></td><td class="cellAmt"><input class="num money inc" inputmode="numeric" value="0"></td><td class="cellDesc"><input value=""></td><td class="cellAmt"><input class="num money exp" inputmode="numeric" value="0"></td><td><input value=""></td></tr>
          </tbody>

          <tfoot>
            <tr>
              <th class="center">합&nbsp;&nbsp;계</th>
              <th class="right"><input id="incSum" class="num" readonly value="0"></th>
              <th class="center">합&nbsp;&nbsp;계</th>
              <th class="right"><input id="expSum" class="num" readonly value="0"></th>
              <th class="right"><input id="netFoot" class="num" readonly value="0"></th>
            </tr>
          </tfoot>
        </table>

        <div class="sectionTitle" style="margin-top:14px;">
          <span class="dot"></span>
          <span class="editText" contenteditable="true" id="titleBank">12월 은행 입출금 내역</span>
        </div>

        <div class="bankWrap">
          <div class="bankTables">

            <div>
              <div class="bankTopTitle"><span class="editText" contenteditable="true">기 업 은 행</span></div>
              <div class="prevRow">
                <div class="label"><span class="editText" contenteditable="true">전월이월액</span></div>
                <div class="val"><input id="ibPrev" class="num money" inputmode="numeric" value="15,541,634"></div>
              </div>

              <table class="bankTbl" id="ibTable">
                <colgroup><col class="desc"><col class="in"><col class="out"><col class="bal"></colgroup>
                <thead>
                  <tr>
                    <th class="center">적&nbsp;&nbsp;요</th>
                    <th class="center thIn">입&nbsp;&nbsp;금</th>
                    <th class="center thOut">출&nbsp;&nbsp;금</th>
                    <th class="center thBal">잔&nbsp;&nbsp;액</th>
                  </tr>
                </thead>
                <tbody>
                  <tr><td class="cellDesc"><input value="전력거래소"></td><td class="cellAmt"><input class="num money ib-in" inputmode="numeric" value="8,508,100"></td><td class="cellAmt"><input class="num money ib-out" inputmode="numeric" value="0"></td><td><input class="num ib-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value="염전마을주"></td><td class="cellAmt"><input class="num money ib-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money ib-out" inputmode="numeric" value="15,500,000"></td><td><input class="num ib-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value="이자"></td><td class="cellAmt"><input class="num money ib-in" inputmode="numeric" value="946"></td><td class="cellAmt"><input class="num money ib-out" inputmode="numeric" value="0"></td><td><input class="num ib-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value="전력거래소"></td><td class="cellAmt"><input class="num money ib-in" inputmode="numeric" value="6,967,300"></td><td class="cellAmt"><input class="num money ib-out" inputmode="numeric" value="0"></td><td><input class="num ib-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value="전력거래소"></td><td class="cellAmt"><input class="num money ib-in" inputmode="numeric" value="4,527,300"></td><td class="cellAmt"><input class="num money ib-out" inputmode="numeric" value="0"></td><td><input class="num ib-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value="염전마을주"></td><td class="cellAmt"><input class="num money ib-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money ib-out" inputmode="numeric" value="14,300,000"></td><td><input class="num ib-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value="전력거래소"></td><td class="cellAmt"><input class="num money ib-in" inputmode="numeric" value="1,895,650"></td><td class="cellAmt"><input class="num money ib-out" inputmode="numeric" value="0"></td><td><input class="num ib-bal" readonly></td></tr>

                  <tr><td class="cellDesc"><input value=""></td><td class="cellAmt"><input class="num money ib-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money ib-out" inputmode="numeric" value="0"></td><td><input class="num ib-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value=""></td><td class="cellAmt"><input class="num money ib-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money ib-out" inputmode="numeric" value="0"></td><td><input class="num ib-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value=""></td><td class="cellAmt"><input class="num money ib-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money ib-out" inputmode="numeric" value="0"></td><td><input class="num ib-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value=""></td><td class="cellAmt"><input class="num money ib-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money ib-out" inputmode="numeric" value="0"></td><td><input class="num ib-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value=""></td><td class="cellAmt"><input class="num money ib-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money ib-out" inputmode="numeric" value="0"></td><td><input class="num ib-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value=""></td><td class="cellAmt"><input class="num money ib-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money ib-out" inputmode="numeric" value="0"></td><td><input class="num ib-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value=""></td><td class="cellAmt"><input class="num money ib-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money ib-out" inputmode="numeric" value="0"></td><td><input class="num ib-bal" readonly></td></tr>
                </tbody>
                <tfoot>
                  <tr>
                    <th class="center">합&nbsp;&nbsp;계</th>
                    <th class="right"><input id="ibInSum" class="num" readonly></th>
                    <th class="right"><input id="ibOutSum" class="num" readonly></th>
                    <th class="right"><input id="ibEnd" class="num" readonly></th>
                  </tr>
                </tfoot>
              </table>
            </div>

            <div>
              <div class="bankTopTitle"><span class="editText" contenteditable="true">농&nbsp;&nbsp;협</span></div>
              <div class="prevRow">
                <div class="label"><span class="editText" contenteditable="true">전월이월액</span></div>
                <div class="val"><input id="nhPrev" class="num money" inputmode="numeric" value="10,012,941"></div>
              </div>

              <table class="bankTbl" id="nhTable">
                <colgroup><col class="desc"><col class="in"><col class="out"><col class="bal"></colgroup>
                <thead>
                  <tr>
                    <th class="center">적&nbsp;&nbsp;요</th>
                    <th class="center thIn">입&nbsp;&nbsp;금</th>
                    <th class="center thOut">출&nbsp;&nbsp;금</th>
                    <th class="center thBal">잔&nbsp;&nbsp;액</th>
                  </tr>
                </thead>
                <tbody>
                  <tr><td class="cellDesc"><input value="이음북스"></td><td class="cellAmt"><input class="num money nh-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money nh-out" inputmode="numeric" value="93,700"></td><td><input class="num nh-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value="이사회식대"></td><td class="cellAmt"><input class="num money nh-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money nh-out" inputmode="numeric" value="52,000"></td><td><input class="num nh-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value="염전마을주"></td><td class="cellAmt"><input class="num money nh-in" inputmode="numeric" value="15,500,000"></td><td class="cellAmt"><input class="num money nh-out" inputmode="numeric" value="0"></td><td><input class="num nh-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value="송전료"></td><td class="cellAmt"><input class="num money nh-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money nh-out" inputmode="numeric" value="347,720"></td><td><input class="num nh-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value="김균태회계"></td><td class="cellAmt"><input class="num money nh-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money nh-out" inputmode="numeric" value="154,000"></td><td><input class="num nh-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value="보상금"></td><td class="cellAmt"><input class="num money nh-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money nh-out" inputmode="numeric" value="10,500,500"></td><td><input class="num nh-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value="대표,이사회수당"></td><td class="cellAmt"><input class="num money nh-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money nh-out" inputmode="numeric" value="800,000"></td><td><input class="num nh-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value="군청근조화환"></td><td class="cellAmt"><input class="num money nh-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money nh-out" inputmode="numeric" value="100,000"></td><td><input class="num nh-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value="운영비"></td><td class="cellAmt"><input class="num money nh-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money nh-out" inputmode="numeric" value="11,000,500"></td><td><input class="num nh-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value="이자"></td><td class="cellAmt"><input class="num money nh-in" inputmode="numeric" value="5,492"></td><td class="cellAmt"><input class="num money nh-out" inputmode="numeric" value="0"></td><td><input class="num nh-bal" readonly></td></tr>

                  <tr><td class="cellDesc"><input value=""></td><td class="cellAmt"><input class="num money nh-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money nh-out" inputmode="numeric" value="0"></td><td><input class="num nh-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value=""></td><td class="cellAmt"><input class="num money nh-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money nh-out" inputmode="numeric" value="0"></td><td><input class="num nh-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value=""></td><td class="cellAmt"><input class="num money nh-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money nh-out" inputmode="numeric" value="0"></td><td><input class="num nh-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value=""></td><td class="cellAmt"><input class="num money nh-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money nh-out" inputmode="numeric" value="0"></td><td><input class="num nh-bal" readonly></td></tr>
                </tbody>
                <tfoot>
                  <tr>
                    <th class="center">합&nbsp;&nbsp;계</th>
                    <th class="right"><input id="nhInSum" class="num" readonly></th>
                    <th class="right"><input id="nhOutSum" class="num" readonly></th>
                    <th class="right"><input id="nhEnd" class="num" readonly></th>
                  </tr>
                </tfoot>
              </table>
            </div>

          </div>
        </div>

        <div class="integratedBox">
          <div class="integratedVal" id="integratedBal">0</div>

          <div class="integratedMeta">
            <div class="metaLine1">
              <span class="editText" id="reportDateText" contenteditable="true">2025년 12월 31일</span>
            </div>

            <div class="metaLine2">
              <span class="editText signLine" contenteditable="true">
                염전마을주민발전주식회사&nbsp;&nbsp;대표이사&nbsp;&nbsp;
                김&nbsp;&nbsp;진&nbsp;&nbsp;
                <span class="nameLast">
                  욱
                  <img src="stamp.PNG" class="ceoStampBig" alt="직인">
                </span>
              </span>
            </div>
          </div>
        </div>

<script>
/* ===== iPhone 한 장 자동 축소 ===== */
(function(){
  const wrap = document.getElementById('sheetWrap');
  const stage = document.querySelector('.stage');
  if(!wrap || !stage) return;

  function px(v){ return Number(String(v).replace('px','')) || 0; }
  function fit(){
    const vw = document.documentElement.clientWidth;
    const base = parseFloat(getComputedStyle(document.documentElement)
      .getPropertyValue('--sheet-w')) || 920;

    const st = getComputedStyle(stage);
    const usable = Math.max(320, vw - px(st.paddingLeft) - px(st.paddingRight));
    wrap.style.setProperty('--scale', Math.min(1, usable / base).toFixed(4));
  }
  window.addEventListener('resize', fit, {passive:true});
  fit();
})();

/* ===== integratedBal 영구 숨김 ===== */
function hideIntegratedBalForever(){
  const el = document.getElementById('integratedBal');
  if(el) el.style.display = 'none';
}
hideIntegratedBalForever();

/* ===== 숫자 유틸 ===== */
function toNumber(v){
  const s = String(v ?? '').replace(/[^\d\-]/g,'');
  if(s === '' || s === '-') return 0;
  const n = Number(s);
  return Number.isFinite(n) ? n : 0;
}
function fmt(n){
  const sign = n < 0 ? '-' : '';
  return sign + Math.abs(Math.round(n))
    .toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');
}
function normalizeMoney(el){
  el.value = fmt(toNumber(el.value));
}

/* ===== 계산 ===== */
function sumInputs(sel){
  let s = 0;
  document.querySelectorAll(sel).forEach(el => s += toNumber(el.value));
  return s;
}

function recalcIncomeExpense(){
  const inc = sumInputs('#incomeExpenseTable .inc');
  const exp = sumInputs('#incomeExpenseTable .exp');
  const net = inc - exp;

  incSum.value = fmt(inc);
  expSum.value = fmt(exp);
  netFoot.value = fmt(net);
  net.value = fmt(net);

  endBal.value = fmt(toNumber(carry.value) + net);
}

function recalcBankOne(tbl, prevId, inSel, outSel, balSel, inSumId, outSumId, endId){
  let bal = toNumber(document.getElementById(prevId).value);
  let ins = 0, outs = 0;

  document.querySelectorAll(tbl+' tbody tr').forEach(tr=>{
    const i = toNumber(tr.querySelector(inSel)?.value);
    const o = toNumber(tr.querySelector(outSel)?.value);
    ins += i; outs += o;
    bal = bal + i - o;
    const b = tr.querySelector(balSel);
    if(b) b.value = fmt(bal);
  });

  document.getElementById(inSumId).value = fmt(ins);
  document.getElementById(outSumId).value = fmt(outs);
  document.getElementById(endId).value = fmt(bal);
  return bal;
}

function recalcAll(){
  recalcIncomeExpense();
  recalcBankOne('#ibTable','ibPrev','.ib-in','.ib-out','.ib-bal','ibInSum','ibOutSum','ibEnd');
  recalcBankOne('#nhTable','nhPrev','.nh-in','.nh-out','.nh-bal','nhInSum','nhOutSum','nhEnd');
  hideIntegratedBalForever();
}

/* ===== 저장 키 ===== */
const STORAGE_PREFIX = 'YEOMJEON_SETTLEMENT_REPORT_V1';
function monthKey(d){
  return `${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,'0')}`;
}
function storageKey(mk){ return `${STORAGE_PREFIX}:${mk}`; }
function prevMonthKey(d){
  const x = new Date(d.getFullYear(), d.getMonth()-1, 1);
  return monthKey(x);
}

/* ===== 상태 저장 ===== */
function collectState(){
  const s = { inputs:{}, edits:{} };
  document.querySelectorAll('input').forEach((el,i)=>{
    s.inputs[el.id || `i${i}`] = el.value;
  });
  document.querySelectorAll('[contenteditable="true"]').forEach((el,i)=>{
    s.edits[el.id || `e${i}`] = el.innerHTML;
  });
  return s;
}
function applyState(s){
  if(!s) return;
  document.querySelectorAll('input').forEach((el,i)=>{
    const k = el.id || `i${i}`;
    if(k in s.inputs) el.value = s.inputs[k];
  });
  document.querySelectorAll('[contenteditable="true"]').forEach((el,i)=>{
    const k = el.id || `e${i}`;
    if(k in s.edits) el.innerHTML = s.edits[k];
  });
}

/* ===== 상단 첫칸: 지난달 이월금액 자동 표기 ===== */
function patchCarryHeaderToPrevMonth(){
  const h = document.querySelector('.summary .sumCell:nth-child(1) .sumHead [contenteditable="true"]');
  if(!h || h.dataset.locked === '1') return;

  const now = new Date();
  const prev = new Date(now.getFullYear(), now.getMonth()-1, 1);
  h.innerText = `${prev.getMonth()+1}월 이월금액`;
  h.dataset.locked = '1';
}

/* ===== 월 초기화 규칙 ===== */
function resetForNewMonth(prevEndBal){
  carry.value = prevEndBal || '0';

  document.querySelectorAll('input.money').forEach(el=>{
    if(el.id !== 'carry') el.value = '0';
  });

  ['net','endBal','incSum','expSum','netFoot',
   'ibInSum','ibOutSum','ibEnd','nhInSum','nhOutSum','nhEnd'
  ].forEach(id=>{
    const el = document.getElementById(id);
    if(el) el.value = '0';
  });

  patchCarryHeaderToPrevMonth();
  hideIntegratedBalForever();
}

/* ===== 이벤트 ===== */
let saveTimer;
function scheduleSave(key){
  clearTimeout(saveTimer);
  saveTimer = setTimeout(()=>{
    localStorage.setItem(key, JSON.stringify(collectState()));
  }, 250);
}

document.querySelectorAll('input.money').forEach(el=>{
  el.addEventListener('input', ()=>{ recalcAll(); scheduleSave(CUR_KEY); });
  el.addEventListener('blur', ()=>{ normalizeMoney(el); recalcAll(); scheduleSave(CUR_KEY); });
  normalizeMoney(el);
});
document.querySelectorAll('[contenteditable="true"]').forEach(el=>{
  el.addEventListener('input', ()=>scheduleSave(CUR_KEY));
  el.addEventListener('blur', ()=>scheduleSave(CUR_KEY));
});

/* ===== 부팅 ===== */
const NOW = new Date();
const CUR_KEY = storageKey(monthKey(NOW));
const PREV_KEY = storageKey(prevMonthKey(NOW));

const saved = localStorage.getItem(CUR_KEY);
if(saved){
  applyState(JSON.parse(saved));
}else{
  const prev = localStorage.getItem(PREV_KEY);
  const prevEnd = prev ? JSON.parse(prev).inputs?.endBal : '0';
  resetForNewMonth(prevEnd);
}

recalcAll();
hideIntegratedBalForever();
localStorage.setItem(CUR_KEY, JSON.stringify(collectState()));
</script>
</body>
</html>







