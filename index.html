<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>2025년 12월 결산 보고서</title>
  <style>
    :root{
      --ink:#111;
      --grid:#222;
      --bg:#f3f4f6;
      --paper:#fff;
      --red:#d82222;

      /* “사진처럼 한 장” 기준 폭 */
      --sheet-w: 900px;
      --pad: 18px;

      --b: 3px;
      --b2: 2px;

      --font: "Apple SD Gothic Neo","Noto Sans KR",system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;

      /* 은행표 헤더 색(캡쳐 느낌) */
      --in-bg:#dfe9ff;
      --out-bg:#ffe4db;
      --bal-bg:#dff7e7;
    }

    *{ box-sizing:border-box; }
    body{
      margin:0;
      background:var(--bg);
      font-family:var(--font);
      color:var(--ink);
    }

    /* iPhone에서 “사진처럼 한 장” 자동 스케일 */
    .stage{
      display:flex;
      justify-content:center;
      padding:14px 8px 40px;
    }
    .wrap{
      width:var(--sheet-w);
      transform-origin: top center;
      transform: scale(var(--scale, 1));
    }
    .sheet{
      width:var(--sheet-w);
      background:var(--paper);
      border:1px solid #d5d7db;
      box-shadow:0 8px 28px rgba(0,0,0,.08);
      padding:var(--pad);
    }

    /* “입력칸처럼 안 보이게” */
    input{
      width:100%;
      border:0;
      outline:none;
      background:transparent;
      font:inherit;
      color:inherit;
      padding:0;
      margin:0;
      min-width:0;
      font-size:16px; /* iOS 자동 줌 방지 */
      line-height:1.2;
    }
    .num{
      text-align:right;
      font-variant-numeric: tabular-nums;
      letter-spacing:0.2px;
    }
    .readonly{
      pointer-events:none;
      user-select:text;
    }

    /* 제목 정중앙 + 수정 가능 */
    .title{
      text-align:center;
      font-weight:900;
      font-size:54px;
      letter-spacing:-1px;
      margin:8px 0 14px;
      color:#143a63;
      line-height:1.05;
    }
    .title input{ text-align:center; font-weight:900; font-size:54px; color:#143a63; }

    /* 공통 표 */
    table{ width:100%; border-collapse:collapse; table-layout:fixed; }
    .tbl{ border:var(--b) solid var(--ink); }
    .tbl th,.tbl td{
      border:var(--b2) solid var(--grid);
      padding:6px 8px;
      font-size:15px;
      vertical-align:middle;
    }
    .tbl th{
      background:#f2f2f2;
      text-align:center;
      font-weight:900;
      letter-spacing:2px;
    }
    .center{ text-align:center; }
    .right{ text-align:right; }
    .bold{ font-weight:900; }

    /* 상단 요약 3칸 */
    .summary{
      border:var(--b) solid var(--ink);
      margin:4px 0 14px;
    }
    .summaryGrid{ display:grid; grid-template-columns: 1fr 1fr 1fr; }
    .sumCell{ border-right:var(--b) solid var(--ink); }
    .sumCell:last-child{ border-right:0; }
    .sumHead{
      border-bottom:var(--b) solid var(--ink);
      text-align:center;
      font-size:20px;
      padding:10px 8px;
      letter-spacing:2px;
      font-weight:900;
    }
    .sumVal{
      text-align:center;
      font-weight:900;
      font-size:36px;
      padding:14px 10px;
    }
    .sumVal input{
      text-align:center;
      font-weight:900;
      font-size:36px;
    }
    .sumVal.red{ color:var(--red); }
    .sumVal.red input{ color:var(--red); }

    /* 섹션 타이틀 */
    .sectionTitle{
      display:flex;
      align-items:center;
      gap:10px;
      margin:12px 0 8px;
      font-weight:900;
      font-size:22px;
    }
    .dot{
      width:18px; height:18px;
      border:2px solid var(--ink);
      border-radius:50%;
      flex:0 0 auto;
    }

    /* 수입/지출 안내 줄 */
    .noteLine{
      border:var(--b) solid var(--ink);
      padding:8px 10px;
      margin:-2px 0 8px;
      font-size:14px;
      color:#222;
      text-align:center;
      font-weight:700;
    }

    /* 수입/지출 표 컬럼 */
    .io col.inDesc{ width:30%; }
    .io col.inAmt{ width:14%; }
    .io col.outDesc{ width:30%; }
    .io col.outAmt{ width:14%; }
    .io col.bigo{ width:12%; }

    /* 은행 영역(통장잔액 표/컬럼 완전 삭제 → 기업/농협 폭 확장) */
    .bankArea{
      border:var(--b) solid var(--ink);
      padding:10px;
    }
    .bankTopTitles{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
      margin-bottom:8px;
    }
    .bankTitle{
      border:var(--b) solid var(--ink);
      text-align:center;
      font-weight:900;
      padding:6px 0;
      letter-spacing:5px;
      font-size:18px;
    }
    .bankGrid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
      align-items:start;
    }
    .bankTbl{ border:var(--b) solid var(--ink); }
    .bankTbl th,.bankTbl td{
      border:var(--b2) solid var(--grid);
      padding:6px 8px;
      font-size:14px;
    }
    .bankTbl .prevRow td{
      font-weight:900;
      background:#f7f7f7;
    }
    .bankTbl .prevRow td:first-child{
      text-align:center;
      letter-spacing:2px;
      width:140px;
      white-space:nowrap;
    }
    .bankTbl .head2 th{ font-weight:900; letter-spacing:2px; }
    .bankTbl .h-in{ background:var(--in-bg); }
    .bankTbl .h-out{ background:var(--out-bg); }
    .bankTbl .h-bal{ background:var(--bal-bg); }

    /* 숫자 안 잘리게 컬럼 배분(기업/농협 폭 자체가 넓어짐) */
    .bankTbl col.desc{ width:38%; }
    .bankTbl col.in{ width:20%; }
    .bankTbl col.out{ width:20%; }
    .bankTbl col.bal{ width:22%; }

    /* 은행 합계행 */
    .sumRow td{
      font-weight:900;
      background:#f7f7f7;
    }

    /* 통합잔액(맨 아래 1칸만 유지) */
    .integrated{
      border:var(--b) solid var(--ink);
      margin-top:10px;
      display:grid;
      grid-template-columns: 1fr 260px;
      align-items:stretch;
    }
    .integrated .label{
      padding:10px 12px;
      font-weight:900;
      letter-spacing:2px;
      display:flex;
      align-items:center;
    }
    .integrated .val{
      border-left:var(--b2) solid var(--grid);
      padding:10px 12px;
      display:flex;
      justify-content:flex-end;
      align-items:center;
      font-size:34px;
      font-weight:900;
      color:var(--red);
      font-variant-numeric: tabular-nums;
    }

    /* 하단: 테두리 제거(요구사항) */
    .footerDate{
      margin:14px 0 10px;
      text-align:center;
      font-weight:900;
      letter-spacing:2px;
    }
    .footerDate input{ text-align:center; font-weight:900; letter-spacing:2px; }
    .footerRow{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:12px;
      align-items:center;
      margin-top:6px;
    }
    .footerText{
      text-align:center;
      font-weight:900;
      letter-spacing:2px;
      font-size:22px;
      padding:8px 0;
    }
    .footerText input{ text-align:center; font-weight:900; font-size:22px; letter-spacing:2px; }

    @media print{
      body{ background:#fff; }
      .stage{ padding:0; }
      .sheet{ border:0; box-shadow:none; }
      .wrap{ transform:none !important; }
    }
  </style>
</head>

<body>
  <div class="stage">
    <div class="wrap" id="wrap">
      <div class="sheet" id="sheet">

        <!-- ✅ 상단 로고/사인/직인 영역 완전 삭제 -->
        <div class="title">
          <input id="docTitle" value="2025년 12월 결산 보고서">
        </div>

        <!-- ✅ 상단 요약 3칸(설명문구 숨김 / 숫자 자동) -->
        <div class="summary">
          <div class="summaryGrid">
            <div class="sumCell">
              <div class="sumHead">11월 이월금액</div>
              <div class="sumVal">
                <input id="carry" class="num" inputmode="numeric" value="25,554,575">
              </div>
            </div>
            <div class="sumCell">
              <div class="sumHead">수&nbsp;&nbsp;입 - 지&nbsp;&nbsp;출</div>
              <div class="sumVal">
                <input id="net" class="num readonly" tabindex="-1" value="0">
              </div>
            </div>
            <div class="sumCell">
              <div class="sumHead">12월 31일 통 장 잔 액</div>
              <div class="sumVal red">
                <input id="endBal" class="num readonly" tabindex="-1" value="0">
              </div>
            </div>
          </div>
        </div>

        <!-- ✅ 12월 수입/지출 내역서 -->
        <div class="sectionTitle">
          <span class="dot"></span><span>12월 수입/지출 내역서</span>
        </div>
        <div class="noteLine">( 수입은 한달전 생산된 금액입니다. 한달지연 입금됩니다 )</div>

        <table class="tbl io" id="ioTbl">
          <colgroup>
            <col class="inDesc"><col class="inAmt"><col class="outDesc"><col class="outAmt"><col class="bigo">
          </colgroup>
          <thead>
            <tr>
              <th colspan="2">수&nbsp;&nbsp;입</th>
              <th colspan="2">지&nbsp;&nbsp;출</th>
              <th>비&nbsp;&nbsp;고</th>
            </tr>
            <tr>
              <th>적&nbsp;&nbsp;요</th><th>금&nbsp;&nbsp;액</th>
              <th>적&nbsp;&nbsp;요</th><th>금&nbsp;&nbsp;액</th>
              <th></th>
            </tr>
          </thead>
          <tbody id="ioBody"></tbody>
          <tfoot>
            <tr class="sumRow">
              <td class="center bold">합&nbsp;&nbsp;계</td>
              <td><input id="ioInSum" class="num readonly" tabindex="-1" value="0"></td>
              <td class="center bold">합&nbsp;&nbsp;계</td>
              <td><input id="ioOutSum" class="num readonly" tabindex="-1" value="0"></td>
              <td><input id="ioNetEcho" class="num readonly" tabindex="-1" value="0"></td>
            </tr>
          </tfoot>
        </table>

        <!-- ✅ 12월 은행 입출금 내역 -->
        <div class="sectionTitle" style="margin-top:14px;">
          <span class="dot"></span><span>12월 은행 입출금 내역</span>
        </div>

        <div class="bankArea">
          <div class="bankTopTitles">
            <div class="bankTitle">기 업 은 행</div>
            <div class="bankTitle">농&nbsp;&nbsp;협</div>
          </div>

          <!-- ✅ 통장잔액 표/컬럼 자체 삭제: 2개 표만 존재 -->
          <div class="bankGrid">

            <!-- 기업은행 -->
            <table class="bankTbl" id="ibkTbl">
              <colgroup>
                <col class="desc"><col class="in"><col class="out"><col class="bal">
              </colgroup>
              <thead>
                <tr class="prevRow">
                  <td class="center">전월이월액</td>
                  <td colspan="3"><input id="ibkPrev" class="num" inputmode="numeric" value="15,541,634"></td>
                </tr>
                <tr class="head2">
                  <th>적&nbsp;&nbsp;요</th>
                  <th class="h-in">입&nbsp;&nbsp;금</th>
                  <th class="h-out">출&nbsp;&nbsp;금</th>
                  <th class="h-bal">잔&nbsp;&nbsp;액</th>
                </tr>
              </thead>
              <tbody id="ibkBody"></tbody>
              <tfoot>
                <tr class="sumRow">
                  <td class="center bold">합&nbsp;&nbsp;계</td>
                  <td><input id="ibkInSum" class="num readonly" tabindex="-1" value="0"></td>
                  <td><input id="ibkOutSum" class="num readonly" tabindex="-1" value="0"></td>
                  <td><input id="ibkFinal" class="num readonly" tabindex="-1" value="0"></td>
                </tr>
              </tfoot>
            </table>

            <!-- 농협 -->
            <table class="bankTbl" id="nhTbl">
              <colgroup>
                <col class="desc"><col class="in"><col class="out"><col class="bal">
              </colgroup>
              <thead>
                <tr class="prevRow">
                  <td class="center">전월이월액</td>
                  <td colspan="3"><input id="nhPrev" class="num" inputmode="numeric" value="10,012,941"></td>
                </tr>
                <tr class="head2">
                  <th>적&nbsp;&nbsp;요</th>
                  <th class="h-in">입&nbsp;&nbsp;금</th>
                  <th class="h-out">출&nbsp;&nbsp;금</th>
                  <th class="h-bal">잔&nbsp;&nbsp;액</th>
                </tr>
              </thead>
              <tbody id="nhBody"></tbody>
              <tfoot>
                <tr class="sumRow">
                  <td class="center bold">합&nbsp;&nbsp;계</td>
                  <td><input id="nhInSum" class="num readonly" tabindex="-1" value="0"></td>
                  <td><input id="nhOutSum" class="num readonly" tabindex="-1" value="0"></td>
                  <td><input id="nhFinal" class="num readonly" tabindex="-1" value="0"></td>
                </tr>
              </tfoot>
            </table>

          </div>

          <!-- ✅ 맨 아래 “12월 31일 통합잔액” 1칸만 유지 (통장잔액 문구/칸 없음) -->
          <div class="integrated">
            <div class="label">12월 31일 통합잔액</div>
            <div class="val" id="integratedVal">0</div>
          </div>
        </div>

        <!-- ✅ 하단: 테두리 전부 제거 + 수정 가능 -->
        <div class="footerDate">
          <input id="docDate" value="2025년 12월 31일">
        </div>
        <div class="footerRow">
          <div class="footerText">
            <input id="companyName" value="염전마을주민발전주식회사">
          </div>
          <div class="footerText">
            <input id="ceoName" value="대표이사   김 진 욱">
          </div>
        </div>

      </div>
    </div>
  </div>

<script>
/* =========================
   0) “사진처럼 한 장” 자동 스케일
========================= */
(function(){
  const wrap = document.getElementById("wrap");
  function fit(){
    const vw = Math.min(window.innerWidth, document.documentElement.clientWidth || window.innerWidth);
    const sheetW = 900;
    const pad = 16; // 좌우 여백
    const scale = Math.min(1, (vw - pad) / sheetW);
    wrap.style.setProperty("--scale", String(scale));
  }
  window.addEventListener("resize", fit, {passive:true});
  fit();
})();

/* =========================
   1) 숫자 유틸 (빈칸=0, 콤마)
========================= */
const $ = (s)=>document.querySelector(s);
function parseMoney(v){
  if(v == null) return 0;
  const t = String(v).replace(/[^\d\-]/g,"").trim();
  if(t === "" || t === "-") return 0;
  const n = Number(t);
  return Number.isFinite(n) ? n : 0;
}
function fmtMoney(n){
  const x = Math.trunc(Number(n) || 0);
  return x.toLocaleString("en-US");
}
function normalizeMoneyInput(el){
  if(!el) return;
  const n = parseMoney(el.value);
  el.value = el.value.trim()==="" ? "" : fmtMoney(n);
}

/* =========================
   2) 수입/지출 표: 캡쳐처럼 “고정 줄수”
      (빈줄 포함, 합계는 아래로 모두 합산)
========================= */
const IO_ROWS = 12;  // 캡쳐 기준: 12줄(채움/빈줄 포함)
const ioSeed = [
  {inDesc:"1차 SMP", inAmt:"8,508,100", outDesc:"송전료", outAmt:"347,720", bigo:""},
  {inDesc:"2차 SMP", inAmt:"6,967,300", outDesc:"이사회 식대", outAmt:"52,000", bigo:""},
  {inDesc:"3차 SMP", inAmt:"4,527,300", outDesc:"사람과사람세무사", outAmt:"154,000", bigo:""},
  {inDesc:"4차 SMP", inAmt:"1,895,650", outDesc:"보상금", outAmt:"10,500,500", bigo:""},
  {inDesc:"KT 전력예측", inAmt:"0", outDesc:"대표및이사회수당", outAmt:"800,000", bigo:""},
  {inDesc:"rec", inAmt:"0", outDesc:"군청근조화환", outAmt:"100,000", bigo:""},
  {inDesc:"이자", inAmt:"946", outDesc:"이음북스", outAmt:"93,700", bigo:""},
  {inDesc:"이자", inAmt:"5,492", outDesc:"토지임대료", outAmt:"14,300,000", bigo:""},
  {inDesc:"", inAmt:"0", outDesc:"운영비", outAmt:"11,000,500", bigo:""},
];

function buildIOTable(){
  const tb = $("#ioBody");
  tb.innerHTML = "";
  for(let i=0;i<IO_ROWS;i++){
    const r = ioSeed[i] || {inDesc:"", inAmt:"", outDesc:"", outAmt:"", bigo:""};
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td><input value="${r.inDesc||""}"></td>
      <td><input class="num io-in" inputmode="numeric" value="${r.inAmt||""}"></td>
      <td><input value="${r.outDesc||""}"></td>
      <td><input class="num io-out" inputmode="numeric" value="${r.outAmt||""}"></td>
      <td><input value="${r.bigo||""}"></td>
    `;
    tb.appendChild(tr);
  }
}

/* =========================
   3) 은행 표: “캡쳐 줄칸수대로” 고정
      - 통장잔액(별도 컬럼/표) 완전 삭제
      - 기업/농협 각각 동일한 거래 줄 수
      - 잔액은 자동 누적(수정 불가)
      - 빈칸도 0으로 계산해서 잔액 유지
========================= */
const BANK_ROWS = 14; // ✅ 캡쳐 기준 줄수(거래+빈줄 포함). 필요하면 여기만 바꾸면 전체가 맞춰짐.

const ibkSeed = [
  {desc:"전력거래소", inAmt:"8,508,100", outAmt:"0"},
  {desc:"염전마을주", inAmt:"0", outAmt:"15,500,000"},
  {desc:"이자", inAmt:"946", outAmt:"0"},
  {desc:"전력거래소", inAmt:"6,967,300", outAmt:"0"},
  {desc:"전력거래소", inAmt:"4,527,300", outAmt:"0"},
  {desc:"염전마을주", inAmt:"0", outAmt:"14,300,000"},
  {desc:"전력거래소", inAmt:"1,895,650", outAmt:"0"},
];

const nhSeed = [
  {desc:"이음북스", inAmt:"0", outAmt:"93,700"},
  {desc:"이사회식대", inAmt:"0", outAmt:"52,000"},
  {desc:"염전마을주", inAmt:"15,500,000", outAmt:"0"},
  {desc:"송전료", inAmt:"0", outAmt:"347,720"},
  {desc:"김균태회계", inAmt:"0", outAmt:"154,000"},
  {desc:"보상금", inAmt:"0", outAmt:"10,500,500"},
  {desc:"대표및이사회수당", inAmt:"0", outAmt:"800,000"},
  {desc:"군청근조화환", inAmt:"0", outAmt:"100,000"},
  {desc:"운영비", inAmt:"0", outAmt:"11,000,500"},
  {desc:"이자", inAmt:"5,492", outAmt:"0"},
];

function buildBankBody(tbodySel, seed){
  const tb = $(tbodySel);
  tb.innerHTML = "";
  for(let i=0;i<BANK_ROWS;i++){
    const r = seed[i] || {desc:"", inAmt:"", outAmt:""};
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td><input value="${r.desc||""}"></td>
      <td><input class="num b-in" inputmode="numeric" value="${r.inAmt||""}"></td>
      <td><input class="num b-out" inputmode="numeric" value="${r.outAmt||""}"></td>
      <td><input class="num b-bal readonly" tabindex="-1" value="0"></td>
    `;
    tb.appendChild(tr);
  }
}

/* =========================
   4) 자동 계산
      - 수입/지출 합계(빈칸도 0)
      - 수입-지출 = 수입합계-지출합계
      - 12/31 통장잔액 = 이월 + (수입-지출)
      - 은행: 전월이월액부터 입금-출금 누적 잔액(빈칸 0)
      - 통합잔액 = 기업 최종잔액 + 농협 최종잔액
      - 상단 12/31 통장잔액은 “통합잔액”과 동일하게 맞춤(캡쳐 운영 방식)
========================= */
function calcIO(){
  let inSum = 0;
  let outSum = 0;

  document.querySelectorAll(".io-in").forEach(el=> inSum += parseMoney(el.value));
  document.querySelectorAll(".io-out").forEach(el=> outSum += parseMoney(el.value));

  $("#ioInSum").value = fmtMoney(inSum);
  $("#ioOutSum").value = fmtMoney(outSum);

  const net = inSum - outSum;
  $("#ioNetEcho").value = fmtMoney(net);
  $("#net").value = fmtMoney(net);

  const carry = parseMoney($("#carry").value);
  const endBal = carry + net;
  $("#endBal").value = fmtMoney(endBal);
}

function calcBankOne(prevSel, bodySel, inSumSel, outSumSel, finalSel){
  const prev = parseMoney($(prevSel).value);
  const rows = document.querySelectorAll(bodySel + " tr");

  let bal = prev;
  let inSum = 0;
  let outSum = 0;

  rows.forEach(tr=>{
    const inEl  = tr.querySelector(".b-in");
    const outEl = tr.querySelector(".b-out");
    const balEl = tr.querySelector(".b-bal");

    const inn = parseMoney(inEl.value);   // 빈칸=0
    const out = parseMoney(outEl.value);  // 빈칸=0

    inSum += inn;
    outSum += out;

    bal = bal + inn - out;
    balEl.value = fmtMoney(bal);
  });

  $(inSumSel).value = fmtMoney(inSum);
  $(outSumSel).value = fmtMoney(outSum);
  $(finalSel).value = fmtMoney(bal);

  return bal;
}

function calcBank(){
  const ibkFinal = calcBankOne("#ibkPrev", "#ibkBody", "#ibkInSum", "#ibkOutSum", "#ibkFinal");
  const nhFinal  = calcBankOne("#nhPrev",  "#nhBody",  "#nhInSum",  "#nhOutSum",  "#nhFinal");

  const integrated = ibkFinal + nhFinal;
  $("#integratedVal").textContent = fmtMoney(integrated);

  // ✅ 상단 12/31 통장잔액은 통합잔액으로 “동일 값” 유지
  $("#endBal").value = fmtMoney(integrated);
}

function calcAll(){
  calcIO();
  calcBank();
}

/* =========================
   5) 입력 이벤트 바인딩
========================= */
function bindMoney(el, onChange){
  if(!el) return;
  el.addEventListener("blur", ()=>{ normalizeMoneyInput(el); onChange(); });
  el.addEventListener("input", onChange);
}
function initFormat(){
  document.querySelectorAll('input.num:not(.readonly)').forEach(el=> normalizeMoneyInput(el));
}

function wire(){
  // 상단 이월금액
  bindMoney($("#carry"), calcAll);

  // 수입/지출 금액칸
  document.querySelectorAll(".io-in, .io-out").forEach(el=> bindMoney(el, calcAll));

  // 은행 전월이월액
  bindMoney($("#ibkPrev"), calcAll);
  bindMoney($("#nhPrev"), calcAll);

  // 은행 입/출금
  document.querySelectorAll(".b-in, .b-out").forEach(el=> bindMoney(el, calcAll));

  initFormat();
  calcAll();
}

/* =========================
   6) 초기 생성
========================= */
buildIOTable();
buildBankBody("#ibkBody", ibkSeed);
buildBankBody("#nhBody", nhSeed);
setTimeout(wire, 0);
</script>
</body>
</html>
