<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>2025년 12월 결산 보고서</title>
  <style>
    :root {
      --ink: #111;
      --grid: #222;
      --muted: #666;
      --red: #d82222;
      --sheet-w: 920px;
      --pad: 18px;
      --b: 3px;
      --b2: 2px;
      --font: "Apple SD Gothic Neo", "Noto Sans KR", system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;

      --c-in:  #dfe8f6;
      --c-out: #f6ddcf;
      --c-bal: #d7f1ea;
    }

    * { box-sizing: border-box; }
    html, body {
      margin: 0;
      padding: 0;
      background: #f3f4f6;
      font-family: var(--font);
      color: var(--ink);
      width: 100%;
      overflow-x: hidden;
    }

    .stage {
      width: 100%;
      padding: 14px 10px 40px;
      padding-left: calc(10px + env(safe-area-inset-left));
      padding-right: calc(10px + env(safe-area-inset-right));
    }

    .sheetWrap {
      width: var(--sheet-w);
      position: relative;
      left: 50%;
      transform: translateX(-50%) scale(var(--scale, 1));
      transform-origin: top center;
    }

    .sheet {
      width: 100%;
      background: #fff;
      border: 1px solid #d5d7db;
      box-shadow: 0 8px 28px rgba(0,0,0,.08);
      padding: var(--pad);
    }

    input {
      width: 100%;
      border: 0;
      outline: 0;
      background: transparent;
      font: inherit;
      color: inherit;
      padding: 0;
      margin: 0;
    }

    .num, .money {
      text-align: right;
      font-variant-numeric: tabular-nums;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      table-layout: fixed;
    }

    th, td {
      border: var(--b2) solid var(--grid);
      padding: 6px 8px;
      overflow: hidden;
      white-space: nowrap;
    }

    /* 제목 */
    .titleWrap { margin: 6px 0 14px; padding: 14px 10px 12px; }
    .titleLineTop { 
      height: 6px; margin-bottom: 14px;
      background: linear-gradient(90deg, #9cff4a 0 44%, #6fdc33 44% 46%, #78e63a 46% 100%);
      border-radius: 3px;
    }
    .titleLineBot { 
      height: 6px; margin-top: 14px;
      background: linear-gradient(90deg, #2f7f2b 0 50%, #5fdd33 50% 52%, #2f7f2b 52% 100%);
      border-radius: 3px;
    }
    .titleText {
      font-weight: 900;
      font-size: 56px;
      letter-spacing: -1px;
      line-height: 1.02;
      color: #143a63;
      text-shadow: 4px 4px 0 rgba(0,0,0,.18);
      -webkit-text-stroke: 1px rgba(0,0,0,.25);
      text-align: center;
    }

    /* 상단 요약 */
    .summary {
      border: var(--b) solid var(--ink);
      margin: 6px 0 12px;
    }
    .summaryGrid { display: grid; grid-template-columns: 1fr 1fr 1fr; }
    .sumCell { border-right: var(--b) solid var(--ink); }
    .sumCell:last-child { border-right: 0; }
    .sumHead {
      border-bottom: var(--b) solid var(--ink);
      text-align: center;
      font-size: 20px;
      font-weight: 900;
      letter-spacing: 2px;
      padding: 10px 8px;
    }
    .sumVal {
      text-align: right;
      font-size: 34px;
      font-weight: 900;
      padding: 14px 12px;
    }
    .sumVal.red { color: var(--red); }

    .sectionTitle {
      display: flex;
      align-items: center;
      gap: 10px;
      margin: 14px 0 8px;
      font-size: 22px;
      font-weight: 900;
    }
    .dot {
      width: 18px; height: 18px;
      border: 2px solid var(--ink);
      border-radius: 50%;
    }

    .noteLine {
      border: var(--b) solid var(--ink);
      padding: 8px 10px;
      margin: 0 0 8px;
      font-size: 14px;
      font-weight: 800;
      text-align: center;
    }

    /* 은행 영역 */
    .bankWrap {
      border: var(--b) solid var(--ink);
      padding: 10px;
    }
    .bankTables {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
    }
    .bankTopTitle {
      border-bottom: var(--b2) solid var(--grid);
      font-weight: 900;
      letter-spacing: 4px;
      text-align: center;
      padding: 6px 0;
    }
    .prevRow {
      display: grid;
      grid-template-columns: 140px 1fr;
      border-bottom: var(--b2) solid var(--grid);
    }
    .prevRow .label {
      background: #f7f7f7;
      border-right: var(--b2) solid var(--grid);
      font-weight: 900;
      letter-spacing: 2px;
      text-align: center;
      padding: 8px;
    }
    .prevRow .val {
      font-weight: 900;
      text-align: right;
      padding: 8px;
    }

    .thIn  { background: var(--c-in)  !important; }
    .thOut { background: var(--c-out) !important; }
    .thBal { background: var(--c-bal) !important; }

    /* 통합 잔액 + 도장 영역 */
    .integratedBox {
      border: var(--b) solid var(--ink);
      margin-top: 10px;
      padding: 24px 16px 28px;
      min-height: 160px;
      position: relative;
    }
    .integratedMeta {
      display: flex;
      flex-direction: column;
      gap: 28px;
      text-align: center;
      font-weight: 900;
      color: #143a63;
      text-shadow: 2px 2px 0 rgba(0,0,0,.14);
      letter-spacing: -0.5px;
    }
    .metaLine1, .metaLine2 {
      font-size: 30px;
      line-height: 1.02;
      white-space: nowrap;
    }
    .ceoStamp {
      height: 45px;
      margin-left: 12px;
      vertical-align: middle;
      opacity: 0.92;
    }

    /* 금액 오른쪽 정렬 */
    input.num, input.money,
    .sumVal, .sumVal input,
    #incomeExpenseTable td:nth-child(2) input,
    #incomeExpenseTable td:nth-child(4) input,
    .bankTbl td input {
      text-align: right !important;
      padding-right: 8px !important;
    }

    @media print {
      body { background: #fff; }
      .stage { padding: 0; }
      .sheet { border: 0; box-shadow: none; }
      .sheetWrap { transform: none !important; }
    }
  </style>
</head>
<body>

<div class="stage">
  <div class="sheetWrap" id="sheetWrap">
    <div class="sheet" id="sheet">

      <!-- 제목 -->
      <div class="titleWrap">
        <div class="titleLineTop"></div>
        <div class="titleText" contenteditable="true">2025년 12월 결산 보고서</div>
        <div class="titleLineBot"></div>
      </div>

      <!-- 상단 3칸 요약 -->
      <div class="summary">
        <div class="summaryGrid">
          <div class="sumCell">
            <div class="sumHead"><span contenteditable="true">11월 이월금액</span></div>
            <div class="sumVal"><input id="carry" class="num money" inputmode="numeric" value="25,554,575"></div>
          </div>
          <div class="sumCell">
            <div class="sumHead"><span contenteditable="true">수 입 - 지 출</span></div>
            <div class="sumVal"><input id="net" class="num" value="0" readonly></div>
          </div>
          <div class="sumCell">
            <div class="sumHead"><span contenteditable="true">12월 31일 통 장 잔 액</span></div>
            <div class="sumVal red"><input id="endBal" class="num" value="0" readonly></div>
          </div>
        </div>
      </div>

      <!-- 수입/지출 내역 제목 -->
      <div class="sectionTitle">
        <span class="dot"></span>
        <span contenteditable="true">12월 수입/지출 내역서</span>
      </div>

      <div class="noteLine">
        <span contenteditable="true">（ 수입은 한달전 생산된 금액입니다. 한달지연 입금됩니다 ）</span>
      </div>

      <!-- 수입/지출 테이블 (데이터는 생략, 필요시 붙여넣기) -->
      <table class="tbl" id="incomeExpenseTable">
        <!-- ... 기존 테이블 내용 ... -->
      </table>

      <!-- 은행 입출금 내역 제목 -->
      <div class="sectionTitle" style="margin-top:14px;">
        <span class="dot"></span>
        <span contenteditable="true">12월 은행 입출금 내역</span>
      </div>

      <div class="bankWrap">
        <div class="bankTables">
          <!-- 기업은행, 농협 테이블 내용 (생략) -->
        </div>

        <!-- 통합 잔액 + 도장 영역 -->
        <div class="integratedBox">
          <div class="integratedMeta">
            <div class="metaLine1">
              <span contenteditable="true">2025년 12월 31일</span>
            </div>
            <div class="metaLine2">
              <span contenteditable="true">염전마을주민발전주식회사 대표이사 김진욱</span>
              <img src="stamp.PNG" class="ceoStamp" alt="직인">
            </div>
          </div>
        </div>
      </div>

    </div>
  </div>
</div>

<script>
  // 기존 계산 로직 (생략)
  // recalcAll(); 등 필요시 그대로 사용
</script>

</body>
</html>



