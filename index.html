<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>2025ë…„ 12ì›” ê²°ì‚° ë³´ê³ ì„œ</title>
  <style>
    :root{
      --ink:#111;
      --grid:#222;
      --muted:#666;
      --red:#d82222;

      --sheet-w: 920px;     /* â€œí•œ ì¥â€ ê¸°ì¤€ í­ */
      --pad: 18px;
      --b: 3px;             /* êµµì€ í…Œë‘ë¦¬ */
      --b2: 2px;            /* í‘œ ë‚´ë¶€ì„  */
      --font: "Apple SD Gothic Neo","Noto Sans KR",system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;

      /* ì€í–‰ í‘œ í—¤ë” ìƒ‰ (ìº¡ì²˜ í†¤) */
      --c-in:  #dfe8f6;     /* ì…ê¸ˆ */
      --c-out: #f6ddcf;     /* ì¶œê¸ˆ */
      --c-bal: #d7f1ea;     /* ì”ì•¡ */
    }

    *{ box-sizing:border-box; }
    body{
      margin:0;
      background:#f3f4f6;
      font-family:var(--font);
      color:var(--ink);
    }

    /* iPhoneì—ì„œ ì‚¬ì§„ì²˜ëŸ¼ â€œí•œ ì¥â€ */
    .stage{
      display:flex;
      justify-content:center;
      padding:14px 8px 40px;
    }
    .sheetWrap{
      width:var(--sheet-w);
      transform-origin: top center;
      transform: scale(var(--scale, 1));
    }
    .sheet{
      width:var(--sheet-w);
      background:#fff;
      border:1px solid #d5d7db;
      box-shadow:0 8px 28px rgba(0,0,0,.08);
      padding:var(--pad);
    }

    /* ì…ë ¥ì¹¸ì²˜ëŸ¼ ì•ˆ ë³´ì´ê²Œ */
    input{
      width:100%;
      min-width:0;              /* âœ… í•µì‹¬: ì¹¸ ëŠ˜ì–´ë‚˜ëŠ” ê±° ë°©ì§€ */
      border:0;
      outline:0;
      background:transparent;
      font:inherit;
      color:inherit;
      padding:0;
      margin:0;
    }
    .num{
      text-align:right;
      white-space:nowrap;
    }

    /* âœ… ëª¨ë“  í‘œ: ì ˆëŒ€ ëŠ˜ì–´ë‚˜ì§€ ì•Šê²Œ ê³ ì • */
    table{
      width:100%;
      border-collapse:collapse;
      table-layout:fixed;       /* âœ… í•µì‹¬ */
    }
    th, td{
      overflow:hidden;          /* âœ… í•µì‹¬ */
      white-space:nowrap;       /* âœ… í•µì‹¬ */
      text-overflow:clip;
      vertical-align:middle;
    }

    /* ì œëª© */
    .title{
      text-align:center;        /* âœ… ì •ì¤‘ì•™ */
      font-weight:900;
      font-size:56px;
      letter-spacing:-1px;
      margin:6px 0 14px;
      color:#143a63;
      line-height:1.02;
    }

    /* ìƒë‹¨ ë¡œê³ /ì‚¬ì¸/ì§ì¸ ì˜ì—­: âœ… ì™„ì „ ì‚­ì œ(ìš”ì²­) */
    /* (ì•„ì˜ˆ DOM ìì²´ë¥¼ ë§Œë“¤ì§€ ì•ŠìŒ) */

    /* ìš”ì•½ 3ì¹¸ */
    .summary{
      border:var(--b) solid var(--ink);
      margin:6px 0 12px;
    }
    .summaryGrid{
      display:grid;
      grid-template-columns: 1fr 1fr 1fr;
    }
    .sumCell{ border-right:var(--b) solid var(--ink); }
    .sumCell:last-child{ border-right:0; }
    .sumHead{
      border-bottom:var(--b) solid var(--ink);
      text-align:center;
      font-size:20px;
      padding:10px 8px;
      letter-spacing:2px;
      font-weight:900;
    }
    .sumVal{
      text-align:center;
      font-weight:900;
      font-size:34px;
      padding:14px 10px;
    }
    .sumVal.red{ color:var(--red); }
    .sumVal input{
      text-align:center;
      font-weight:900;
      font-size:34px;
    }
    .sumVal.red input{ color:var(--red); }

    /* ìº¡ì²˜ì— ìˆë˜ ì‘ì€ ì£¼ì„ ë¼ì¸: âœ… ìˆ¨ê¹€(ìš”ì²­) */
    .miniNote{ display:none; }

    /* ì„¹ì…˜ íƒ€ì´í‹€(ë™ê·¸ë¼ë¯¸ í¬í•¨) */
    .sectionTitle{
      display:flex;
      align-items:center;
      gap:10px;
      margin:10px 0 8px;
      font-weight:900;
      font-size:22px;
    }
    .dot{
      width:18px; height:18px;
      border:2px solid var(--ink);
      border-radius:50%;
      flex:0 0 auto;
    }
    .editText{
      display:inline-block;
      min-width:10px;
      outline:none;
      cursor:text;
    }

    /* ìˆ˜ì…/ì§€ì¶œ ë‚´ì—­ í‘œ */
    .tbl{
      border:var(--b) solid var(--ink);
    }
    .tbl th, .tbl td{
      border:var(--b2) solid var(--grid);
      padding:6px 8px;
      font-size:16px;
    }
    .tbl th{
      background:#f2f2f2;
      text-align:center;
      font-weight:900;
      letter-spacing:2px;
    }
    .tbl .subhead th{
      background:#f7f7f7;
      letter-spacing:1px;
    }
    .center{ text-align:center; }
    .right{ text-align:right; }
    .bold{ font-weight:900; }

    .noteLine{
      border:var(--b) solid var(--ink);
      padding:8px 10px;
      margin:-2px 0 8px;
      font-size:14px;
      color:#222;
      text-align:center;
      font-weight:800;
    }

    /* ìˆ˜ì…/ì§€ì¶œ í‘œ ì—´í­ (ê³ ì •) */
    .colDesc{ width:34%; }
    .colAmt{ width:16%; }
    .colDesc2{ width:34%; }
    .colAmt2{ width:16%; }
    .colBigo{ width:18%; }

    /* ì€í–‰ ì˜ì—­ */
    .bankWrap{
      border:var(--b) solid var(--ink);
      padding:10px;
    }
    .bankTables{
      display:grid;
      grid-template-columns: 1fr 1fr;   /* âœ… í†µì¥ì”ì•¡ í° ì»¬ëŸ¼ ì‚­ì œ */
      gap:10px;
    }
    .bankTbl{
      border:var(--b) solid var(--ink);
    }
    .bankTbl th, .bankTbl td{
      border:var(--b2) solid var(--grid);
      padding:6px 8px;
      font-size:15px;
    }
    .bankTopTitle{
      border-bottom:var(--b2) solid var(--grid);
      font-weight:900;
      text-align:center;
      letter-spacing:4px;
      padding:6px 0;
      background:#fff;
    }

    /* ì „ì›”ì´ì›”ì•¡ ì¤„ */
    .prevRow{
      display:grid;
      grid-template-columns: 140px 1fr;
      border-bottom:var(--b2) solid var(--grid);
    }
    .prevRow .label{
      background:#f7f7f7;
      border-right:var(--b2) solid var(--grid);
      text-align:center;
      font-weight:900;
      letter-spacing:2px;
      padding:8px 8px;
    }
    .prevRow .val{
      padding:8px 8px;
      font-weight:900;
      text-align:right;
    }

    /* ì€í–‰ ì»¬ëŸ¼ í­: âœ… ì ìš” ì•½ê°„ ì¤„ì´ê³ , ì…ê¸ˆ/ì¶œê¸ˆ/ì”ì•¡ ë„“í˜€ì„œ ì•ˆ ì˜ë¦¬ê²Œ */
    .bankTbl col.desc{ width:34%; }
    .bankTbl col.in{ width:22%; }
    .bankTbl col.out{ width:22%; }
    .bankTbl col.bal{ width:22%; }

    .bankTbl th{ background:#f2f2f2; text-align:center; font-weight:900; }
    .thIn{ background:var(--c-in) !important; }
    .thOut{ background:var(--c-out) !important; }
    .thBal{ background:var(--c-bal) !important; }

    /* ì ìš”/ê¸ˆì•¡ ì¹¸ì— ì‚´ì§ ìƒ‰ (ìš”ì²­) */
    .cellDesc{ background:#fbfbfb; }
    .cellAmt{ background:#fdfdfd; }

    /* í†µí•©ì”ì•¡ ë°•ìŠ¤ */
    .integratedBox{
      border:var(--b) solid var(--ink);
      margin-top:10px;
      padding:10px 12px;
      display:flex;
      flex-direction:column;
      gap:6px;
    }
    .integratedTitle{
      font-weight:900;
      letter-spacing:2px;
      font-size:16px;
    }
    .integratedVal{
      width:100%;
      text-align:right;
      font-size:34px;
      font-weight:900;
      color:var(--red);
    }

    /* í•˜ë‹¨: âœ… í…Œë‘ë¦¬ ì „ë¶€ ì œê±°(ìš”ì²­) */
    .bottomArea{
      position:relative;
      margin-top:14px;
      padding-top:8px;
    }
    .bottomDate{
      text-align:center;
      font-weight:900;
      letter-spacing:2px;
      margin:2px 0 6px;
    }
    .bottomRow{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
      align-items:center;
      margin-top:2px;
    }
    .bottomText{
      text-align:center;
      font-weight:900;
      letter-spacing:2px;
      padding:6px 0;
    }

    /* ë„ì¥(íˆ¬ëª… ì²˜ë¦¬ í›„) ì˜¤ë²„ë ˆì´: â€œê¹€ì§„ìš±(ìš±)â€ ìª½ì— ê²¹ì¹˜ê¸° */
    .stampOverlay{
      position:absolute;
      right:34px;         /* âœ… ì˜¤ë¥¸ìª½ì—ì„œ ì‚´ì§ ì•ˆìª½ */
      bottom:-6px;        /* âœ… ì•„ë˜ë¡œ ì‚´ì§ */
      width:92px;
      height:92px;
      pointer-events:none;
      opacity:.92;
      transform: rotate(-2deg);
    }

    /* í”„ë¦°íŠ¸ */
    @media print{
      body{ background:#fff; }
      .stage{ padding:0; }
      .sheet{ border:0; box-shadow:none; }
      .sheetWrap{ transform:none !important; }
    }
  </style>
</head>

<body>
  <div class="stage">
    <div class="sheetWrap" id="sheetWrap">
      <div class="sheet" id="sheet">

        <div class="title">2025ë…„&nbsp;&nbsp;12ì›”&nbsp;&nbsp;ê²°ì‚° ë³´ê³ ì„œ</div>

        <!-- âœ… ìƒë‹¨ ë¡œê³ /ì‚¬ì¸/ì§ì¸ ì˜ì—­ ì‚­ì œ (ìš”ì²­) -->

        <!-- ìš”ì•½ 3ì¹¸ -->
        <div class="summary">
          <div class="summaryGrid">
            <div class="sumCell">
              <div class="sumHead">
                <span class="editText" contenteditable="true">11ì›” ì´ì›”ê¸ˆì•¡</span>
              </div>
              <div class="sumVal">
                <input id="carry" class="num money" inputmode="numeric" value="25,554,575">
              </div>
            </div>
            <div class="sumCell">
              <div class="sumHead">
                <span class="editText" contenteditable="true">ìˆ˜ ì… - ì§€ ì¶œ</span>
              </div>
              <div class="sumVal">
                <input id="net" class="num" value="0" readonly>
              </div>
            </div>
            <div class="sumCell">
              <div class="sumHead">
                <span class="editText" contenteditable="true">12ì›” 31ì¼ í†µ ì¥ ì” ì•¡</span>
              </div>
              <div class="sumVal red">
                <input id="endBal" class="num" value="0" readonly>
              </div>
            </div>
          </div>
        </div>

        <!-- âœ… ìº¡ì²˜ì— ìˆë˜ ì‘ì€ ì„¤ëª…ë¬¸(â€˜2ë²ˆí‘œâ€¦â€™)ì€ ìˆ¨ê¹€ ì²˜ë¦¬ -->
        <div class="miniNote"></div>

        <!-- 12ì›” ìˆ˜ì…/ì§€ì¶œ ë‚´ì—­ì„œ -->
        <div class="sectionTitle">
          <span class="dot"></span>
          <span class="editText" contenteditable="true" id="titleIncomeExpense">12ì›” ìˆ˜ì…/ì§€ì¶œ ë‚´ì—­ì„œ</span>
        </div>

        <div class="noteLine">
          <span class="editText" contenteditable="true">ï¼ˆ ìˆ˜ì…ì€ í•œë‹¬ì „ ìƒì‚°ëœ ê¸ˆì•¡ì…ë‹ˆë‹¤. í•œë‹¬ì§€ì—° ì…ê¸ˆë©ë‹ˆë‹¤ ï¼‰</span>
        </div>

        <table class="tbl" id="incomeExpenseTable">
          <colgroup>
            <col class="colDesc"><col class="colAmt">
            <col class="colDesc2"><col class="colAmt2">
            <col class="colBigo">
          </colgroup>
          <thead>
            <tr>
              <th colspan="2">ìˆ˜&nbsp;&nbsp;ì…</th>
              <th colspan="2">ì§€&nbsp;&nbsp;ì¶œ</th>
              <th>ë¹„&nbsp;&nbsp;ê³ </th>
            </tr>
            <tr class="subhead">
              <th class="center">ì &nbsp;&nbsp;ìš”</th>
              <th class="center">ê¸ˆ&nbsp;&nbsp;ì•¡</th>
              <th class="center">ì &nbsp;&nbsp;ìš”</th>
              <th class="center">ê¸ˆ&nbsp;&nbsp;ì•¡</th>
              <th class="center"></th>
            </tr>
          </thead>
          <tbody>
            <!-- ìº¡ì²˜ ëŠë‚Œìœ¼ë¡œ 12ì¤„ + ë¹ˆì¹¸ -->
            <tr>
              <td class="cellDesc"><input value="1ì°¨ SMP"></td>
              <td class="cellAmt"><input class="num money inc" inputmode="numeric" value="8,508,100"></td>
              <td class="cellDesc"><input value="ì†¡ì „ë£Œ"></td>
              <td class="cellAmt"><input class="num money exp" inputmode="numeric" value="347,720"></td>
              <td><input value=""></td>
            </tr>
            <tr>
              <td class="cellDesc"><input value="2ì°¨ SMP"></td>
              <td class="cellAmt"><input class="num money inc" inputmode="numeric" value="6,967,300"></td>
              <td class="cellDesc"><input value="ì´ì‚¬íšŒì‹ëŒ€"></td>
              <td class="cellAmt"><input class="num money exp" inputmode="numeric" value="52,000"></td>
              <td><input value=""></td>
            </tr>
            <tr>
              <td class="cellDesc"><input value="3ì°¨ SMP"></td>
              <td class="cellAmt"><input class="num money inc" inputmode="numeric" value="4,527,300"></td>
              <td class="cellDesc"><input value="ì‚¬ëŒê³¼ì‚¬ëŒì„¸ë¬´ì‚¬"></td>
              <td class="cellAmt"><input class="num money exp" inputmode="numeric" value="154,000"></td>
              <td><input value=""></td>
            </tr>
            <tr>
              <td class="cellDesc"><input value="4ì°¨ SMP"></td>
              <td class="cellAmt"><input class="num money inc" inputmode="numeric" value="1,895,650"></td>
              <td class="cellDesc"><input value="ë³´ìƒê¸ˆ"></td>
              <td class="cellAmt"><input class="num money exp" inputmode="numeric" value="10,500,500"></td>
              <td><input value=""></td>
            </tr>
            <tr>
              <td class="cellDesc"><input value="KT ì „ë ¥ì˜ˆì¸¡"></td>
              <td class="cellAmt"><input class="num money inc" inputmode="numeric" value="0"></td>
              <td class="cellDesc"><input value="ëŒ€í‘œ,ì´ì‚¬íšŒìˆ˜ë‹¹"></td>
              <td class="cellAmt"><input class="num money exp" inputmode="numeric" value="800,000"></td>
              <td><input value=""></td>
            </tr>
            <tr>
              <td class="cellDesc"><input value="rec"></td>
              <td class="cellAmt"><input class="num money inc" inputmode="numeric" value="0"></td>
              <td class="cellDesc"><input value="êµ°ì²­ê·¼ì¡°í™”í™˜"></td>
              <td class="cellAmt"><input class="num money exp" inputmode="numeric" value="100,000"></td>
              <td><input value=""></td>
            </tr>
            <tr>
              <td class="cellDesc"><input value="ì´ì"></td>
              <td class="cellAmt"><input class="num money inc" inputmode="numeric" value="946"></td>
              <td class="cellDesc"><input value="ì´ìŒë¶ìŠ¤"></td>
              <td class="cellAmt"><input class="num money exp" inputmode="numeric" value="93,700"></td>
              <td><input value=""></td>
            </tr>
            <tr>
              <td class="cellDesc"><input value="ì´ì"></td>
              <td class="cellAmt"><input class="num money inc" inputmode="numeric" value="5,492"></td>
              <td class="cellDesc"><input value="í† ì§€ì„ëŒ€ë£Œ"></td>
              <td class="cellAmt"><input class="num money exp" inputmode="numeric" value="14,300,000"></td>
              <td><input value=""></td>
            </tr>
            <tr>
              <td class="cellDesc"><input value=""></td>
              <td class="cellAmt"><input class="num money inc" inputmode="numeric" value="0"></td>
              <td class="cellDesc"><input value="ìš´ì˜ë¹„"></td>
              <td class="cellAmt"><input class="num money exp" inputmode="numeric" value="11,000,500"></td>
              <td><input value=""></td>
            </tr>

            <!-- ë¹ˆ ì¤„ë“¤ -->
            <tr><td class="cellDesc"><input value=""></td><td class="cellAmt"><input class="num money inc" inputmode="numeric" value="0"></td><td class="cellDesc"><input value=""></td><td class="cellAmt"><input class="num money exp" inputmode="numeric" value="0"></td><td><input value=""></td></tr>
            <tr><td class="cellDesc"><input value=""></td><td class="cellAmt"><input class="num money inc" inputmode="numeric" value="0"></td><td class="cellDesc"><input value=""></td><td class="cellAmt"><input class="num money exp" inputmode="numeric" value="0"></td><td><input value=""></td></tr>
            <tr><td class="cellDesc"><input value=""></td><td class="cellAmt"><input class="num money inc" inputmode="numeric" value="0"></td><td class="cellDesc"><input value=""></td><td class="cellAmt"><input class="num money exp" inputmode="numeric" value="0"></td><td><input value=""></td></tr>
          </tbody>

          <tfoot>
            <tr>
              <th class="center">í•©&nbsp;&nbsp;ê³„</th>
              <th class="right"><input id="incSum" class="num" readonly value="0"></th>
              <th class="center">í•©&nbsp;&nbsp;ê³„</th>
              <th class="right"><input id="expSum" class="num" readonly value="0"></th>
              <th class="right"><input id="netFoot" class="num" readonly value="0"></th>
            </tr>
          </tfoot>
        </table>

        <!-- 12ì›” ì€í–‰ ì…ì¶œê¸ˆ ë‚´ì—­ -->
        <div class="sectionTitle" style="margin-top:14px;">
          <span class="dot"></span>
          <span class="editText" contenteditable="true" id="titleBank">12ì›” ì€í–‰ ì…ì¶œê¸ˆ ë‚´ì—­</span>
        </div>

        <div class="bankWrap">
          <div class="bankTables">

            <!-- ê¸°ì—…ì€í–‰ -->
            <div>
              <div class="bankTopTitle">
                <span class="editText" contenteditable="true">ê¸° ì—… ì€ í–‰</span>
              </div>
              <div class="prevRow">
                <div class="label"><span class="editText" contenteditable="true">ì „ì›”ì´ì›”ì•¡</span></div>
                <div class="val"><input id="ibPrev" class="num money" inputmode="numeric" value="15,541,634"></div>
              </div>

              <table class="bankTbl" id="ibTable">
                <colgroup>
                  <col class="desc"><col class="in"><col class="out"><col class="bal">
                </colgroup>
                <thead>
                  <tr>
                    <th class="center">ì &nbsp;&nbsp;ìš”</th>
                    <th class="center thIn">ì…&nbsp;&nbsp;ê¸ˆ</th>
                    <th class="center thOut">ì¶œ&nbsp;&nbsp;ê¸ˆ</th>
                    <th class="center thBal">ì”&nbsp;&nbsp;ì•¡</th>
                  </tr>
                </thead>
                <tbody>
                  <!-- âœ… ìº¡ì²˜ ëŠë‚Œì˜ ì¤„ ê°œìˆ˜(ê³ ì •). ê°’ì€ í¸ì§‘/ìë™ê³„ì‚° -->
                  <tr><td class="cellDesc"><input value="ì „ë ¥ê±°ë˜ì†Œ"></td><td class="cellAmt"><input class="num money ib-in" inputmode="numeric" value="8,508,100"></td><td class="cellAmt"><input class="num money ib-out" inputmode="numeric" value="0"></td><td><input class="num ib-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value="ì—¼ì „ë§ˆì„ì£¼"></td><td class="cellAmt"><input class="num money ib-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money ib-out" inputmode="numeric" value="15,500,000"></td><td><input class="num ib-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value="ì´ì"></td><td class="cellAmt"><input class="num money ib-in" inputmode="numeric" value="946"></td><td class="cellAmt"><input class="num money ib-out" inputmode="numeric" value="0"></td><td><input class="num ib-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value="ì „ë ¥ê±°ë˜ì†Œ"></td><td class="cellAmt"><input class="num money ib-in" inputmode="numeric" value="6,967,300"></td><td class="cellAmt"><input class="num money ib-out" inputmode="numeric" value="0"></td><td><input class="num ib-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value="ì „ë ¥ê±°ë˜ì†Œ"></td><td class="cellAmt"><input class="num money ib-in" inputmode="numeric" value="4,527,300"></td><td class="cellAmt"><input class="num money ib-out" inputmode="numeric" value="0"></td><td><input class="num ib-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value="ì—¼ì „ë§ˆì„ì£¼"></td><td class="cellAmt"><input class="num money ib-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money ib-out" inputmode="numeric" value="14,300,000"></td><td><input class="num ib-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value="ì „ë ¥ê±°ë˜ì†Œ"></td><td class="cellAmt"><input class="num money ib-in" inputmode="numeric" value="1,895,650"></td><td class="cellAmt"><input class="num money ib-out" inputmode="numeric" value="0"></td><td><input class="num ib-bal" readonly></td></tr>

                  <!-- ë¹ˆ ì¤„ë“¤(ìº¡ì²˜ì²˜ëŸ¼) -->
                  <tr><td class="cellDesc"><input value=""></td><td class="cellAmt"><input class="num money ib-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money ib-out" inputmode="numeric" value="0"></td><td><input class="num ib-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value=""></td><td class="cellAmt"><input class="num money ib-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money ib-out" inputmode="numeric" value="0"></td><td><input class="num ib-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value=""></td><td class="cellAmt"><input class="num money ib-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money ib-out" inputmode="numeric" value="0"></td><td><input class="num ib-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value=""></td><td class="cellAmt"><input class="num money ib-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money ib-out" inputmode="numeric" value="0"></td><td><input class="num ib-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value=""></td><td class="cellAmt"><input class="num money ib-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money ib-out" inputmode="numeric" value="0"></td><td><input class="num ib-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value=""></td><td class="cellAmt"><input class="num money ib-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money ib-out" inputmode="numeric" value="0"></td><td><input class="num ib-bal" readonly></td></tr>
                </tbody>
                <tfoot>
                  <tr>
                    <th class="center">í•©&nbsp;&nbsp;ê³„</th>
                    <th class="right"><input id="ibInSum" class="num" readonly></th>
                    <th class="right"><input id="ibOutSum" class="num" readonly></th>
                    <th class="right"><input id="ibEnd" class="num" readonly></th>
                  </tr>
                </tfoot>
              </table>
            </div>

            <!-- ë†í˜‘ -->
            <div>
              <div class="bankTopTitle">
                <span class="editText" contenteditable="true">ë†&nbsp;&nbsp;í˜‘</span>
              </div>
              <div class="prevRow">
                <div class="label"><span class="editText" contenteditable="true">ì „ì›”ì´ì›”ì•¡</span></div>
                <div class="val"><input id="nhPrev" class="num money" inputmode="numeric" value="10,012,941"></div>
              </div>

              <table class="bankTbl" id="nhTable">
                <colgroup>
                  <col class="desc"><col class="in"><col class="out"><col class="bal">
                </colgroup>
                <thead>
                  <tr>
                    <th class="center">ì &nbsp;&nbsp;ìš”</th>
                    <th class="center thIn">ì…&nbsp;&nbsp;ê¸ˆ</th>
                    <th class="center thOut">ì¶œ&nbsp;&nbsp;ê¸ˆ</th>
                    <th class="center thBal">ì”&nbsp;&nbsp;ì•¡</th>
                  </tr>
                </thead>
                <tbody>
                  <tr><td class="cellDesc"><input value="ì´ìŒë¶ìŠ¤"></td><td class="cellAmt"><input class="num money nh-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money nh-out" inputmode="numeric" value="93,700"></td><td><input class="num nh-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value="ì´ì‚¬íšŒì‹ëŒ€"></td><td class="cellAmt"><input class="num money nh-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money nh-out" inputmode="numeric" value="52,000"></td><td><input class="num nh-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value="ì—¼ì „ë§ˆì„ì£¼"></td><td class="cellAmt"><input class="num money nh-in" inputmode="numeric" value="15,500,000"></td><td class="cellAmt"><input class="num money nh-out" inputmode="numeric" value="0"></td><td><input class="num nh-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value="ì†¡ì „ë£Œ"></td><td class="cellAmt"><input class="num money nh-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money nh-out" inputmode="numeric" value="347,720"></td><td><input class="num nh-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value="ê¹€ê· íƒœíšŒê³„"></td><td class="cellAmt"><input class="num money nh-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money nh-out" inputmode="numeric" value="154,000"></td><td><input class="num nh-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value="ë³´ìƒê¸ˆ"></td><td class="cellAmt"><input class="num money nh-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money nh-out" inputmode="numeric" value="10,500,500"></td><td><input class="num nh-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value="ëŒ€í‘œ,ì´ì‚¬íšŒìˆ˜ë‹¹"></td><td class="cellAmt"><input class="num money nh-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money nh-out" inputmode="numeric" value="800,000"></td><td><input class="num nh-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value="êµ°ì²­ê·¼ì¡°í™”í™˜"></td><td class="cellAmt"><input class="num money nh-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money nh-out" inputmode="numeric" value="100,000"></td><td><input class="num nh-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value="ìš´ì˜ë¹„"></td><td class="cellAmt"><input class="num money nh-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money nh-out" inputmode="numeric" value="11,000,500"></td><td><input class="num nh-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value="ì´ì"></td><td class="cellAmt"><input class="num money nh-in" inputmode="numeric" value="5,492"></td><td class="cellAmt"><input class="num money nh-out" inputmode="numeric" value="0"></td><td><input class="num nh-bal" readonly></td></tr>

                  <!-- ë¹ˆ ì¤„ë“¤ -->
                  <tr><td class="cellDesc"><input value=""></td><td class="cellAmt"><input class="num money nh-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money nh-out" inputmode="numeric" value="0"></td><td><input class="num nh-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value=""></td><td class="cellAmt"><input class="num money nh-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money nh-out" inputmode="numeric" value="0"></td><td><input class="num nh-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value=""></td><td class="cellAmt"><input class="num money nh-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money nh-out" inputmode="numeric" value="0"></td><td><input class="num nh-bal" readonly></td></tr>
                  <tr><td class="cellDesc"><input value=""></td><td class="cellAmt"><input class="num money nh-in" inputmode="numeric" value="0"></td><td class="cellAmt"><input class="num money nh-out" inputmode="numeric" value="0"></td><td><input class="num nh-bal" readonly></td></tr>
                </tbody>
                <tfoot>
                  <tr>
                    <th class="center">í•©&nbsp;&nbsp;ê³„</th>
                    <th class="right"><input id="nhInSum" class="num" readonly></th>
                    <th class="right"><input id="nhOutSum" class="num" readonly></th>
                    <th class="right"><input id="nhEnd" class="num" readonly></th>
                  </tr>
                </tfoot>
              </table>
            </div>

          </div>

          <!-- í†µí•©ì”ì•¡(ë§¨ ì•„ë˜ 1ì¹¸ë§Œ ìœ ì§€) -->
          <div class="integratedBox">
            <div class="integratedTitle">
              <span class="editText" contenteditable="true">12ì›” 31ì¼ í†µí•©ì”ì•¡</span>
            </div>
            <div class="integratedVal" id="integratedBal">0</div>
          </div>
        </div>

        <!-- í•˜ë‹¨ (í…Œë‘ë¦¬ ì œê±°) + ë„ì¥ ì˜¤ë²„ë ˆì´ -->
        <div class="bottomArea">
          <div class="bottomDate">
            <span class="editText" contenteditable="true">2025ë…„ 12ì›” 31ì¼</span>
          </div>
          <div class="bottomRow">
            <div class="bottomText"><span class="editText" contenteditable="true">ì—¼ì „ë§ˆì„ì£¼ë¯¼ë°œì „ì£¼ì‹íšŒì‚¬</span></div>
            <div class="bottomText" id="ceoLine"><span class="editText" contenteditable="true">ëŒ€í‘œì´ì‚¬&nbsp;&nbsp;&nbsp;ê¹€&nbsp;ì§„&nbsp;ìš±</span></div>
          </div>

          <!-- ë„ì¥(íˆ¬ëª… ì²˜ë¦¬ í›„ ì—¬ê¸°ë¡œ ë“¤ì–´ì˜´) -->
          <img id="stampOut" class="stampOverlay" alt="ì§ì¸">
        </div>

      </div>
    </div>
  </div>

  <script>
    /* ===== iPhone â€œí•œ ì¥ ìë™ ì¶•ì†Œâ€ ===== */
    (function(){
      const wrap = document.getElementById('sheetWrap');
      function fit(){
        const vw = Math.min(window.innerWidth - 16, window.screen?.width ? window.screen.width - 16 : window.innerWidth - 16);
        const base = parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--sheet-w')) || 920;
        const scale = Math.min(1, vw / base);
        wrap.style.setProperty('--scale', scale.toFixed(4));
      }
      window.addEventListener('resize', fit, {passive:true});
      fit();
    })();

    /* ===== ìˆ«ì íŒŒì‹±/í¬ë§· ===== */
    function toNumber(v){
      if (v == null) return 0;
      const s = String(v).replace(/[^\d\-]/g,'');
      if (s === '' || s === '-') return 0;
      return Number(s) || 0;
    }
    function fmt(n){
      const sign = n < 0 ? '-' : '';
      const abs = Math.abs(Math.trunc(n));
      return sign + abs.toLocaleString('en-US');
    }
    function setInputFormatted(el){
      const n = toNumber(el.value);
      el.value = fmt(n);
    }

    /* ëª¨ë“  money ì…ë ¥: ì…ë ¥ ì¦‰ì‹œ ì½¤ë§ˆ ì •ë¦¬ */
    document.querySelectorAll('input.money').forEach(el=>{
      el.addEventListener('input', ()=> {
        // ìˆ«ì ë„£ì„ ë•Œë„ ì¹¸/í‘œê°€ ì•ˆ ëŠ˜ì–´ë‚˜ê²Œ: ì´ë¯¸ CSSë¡œ ê³ ì •.
        // ì—¬ê¸°ì„œëŠ” ê°’ë§Œ ì •ë¦¬.
        setInputFormatted(el);
        recalcAll();
      });
      // ì´ˆê¸° í¬ë§·
      setInputFormatted(el);
    });

    /* ===== ìˆ˜ì…/ì§€ì¶œ í•©ê³„ ê³„ì‚° ===== */
    function sumInputs(selector){
      let s = 0;
      document.querySelectorAll(selector).forEach(el=>{
        s += toNumber(el.value);
      });
      return s;
    }

    function recalcIncomeExpense(){
      const inc = sumInputs('#incomeExpenseTable .inc');
      const exp = sumInputs('#incomeExpenseTable .exp');
      const net = inc - exp;

      document.getElementById('incSum').value = fmt(inc);
      document.getElementById('expSum').value = fmt(exp);
      document.getElementById('netFoot').value = fmt(net);

      document.getElementById('net').value = fmt(net);

      const carry = toNumber(document.getElementById('carry').value);
      const endBal = carry + net;
      document.getElementById('endBal').value = fmt(endBal);
    }

    /* ===== ì€í–‰ ëˆ„ì  ì”ì•¡ ê³„ì‚° ===== */
    function recalcBankOne(prefix, prevId, inSel, outSel, balSel, inSumId, outSumId, endId){
      let bal = toNumber(document.getElementById(prevId).value);

      let inSum = 0, outSum = 0;

      const rows = document.querySelectorAll(prefix + ' tbody tr');
      rows.forEach(tr=>{
        const inEl  = tr.querySelector(inSel);
        const outEl = tr.querySelector(outSel);
        const balEl = tr.querySelector(balSel);

        const inn = inEl ? toNumber(inEl.value) : 0;
        const out = outEl ? toNumber(outEl.value) : 0;

        inSum += inn;
        outSum += out;

        bal = bal + inn - out;

        if (balEl){
          balEl.value = fmt(bal);
        }
      });

      document.getElementById(inSumId).value = fmt(inSum);
      document.getElementById(outSumId).value = fmt(outSum);
      document.getElementById(endId).value = fmt(bal);

      return bal;
    }

    function recalcBank(){
      const ibEnd = recalcBankOne(
        '#ibTable', 'ibPrev',
        '.ib-in', '.ib-out', '.ib-bal',
        'ibInSum','ibOutSum','ibEnd'
      );

      const nhEnd = recalcBankOne(
        '#nhTable', 'nhPrev',
        '.nh-in', '.nh-out', '.nh-bal',
        'nhInSum','nhOutSum','nhEnd'
      );

      const integrated = ibEnd + nhEnd;
      document.getElementById('integratedBal').textContent = fmt(integrated);
    }

    function recalcAll(){
      recalcIncomeExpense();
      recalcBank();
    }

    // ì´ˆê¸° ê³„ì‚°
    recalcAll();

    /* ===== ë„ì¥ PNG í¬í•¨ + â€œí° ë°°ê²½ íˆ¬ëª…â€ ì²˜ë¦¬ í›„ ì‚½ì… =====
       - ì‚¬ìš©ìê°€ ì¤€ ë„ì¥ ì´ë¯¸ì§€ë¥¼ ì½”ë“œì— ì§ì ‘ í¬í•¨(ë°ì´í„°URI)
       - canvasë¡œ í°ìƒ‰(ê°€ê¹Œìš´ í”½ì…€) íˆ¬ëª…í™”
    */
    const STAMP_DATA_URL = (function(){
      // ì•„ë˜ ë°ì´í„°ëŠ” ì‚¬ìš©ìê°€ ì˜¬ë¦° ë„ì¥ PNGë¥¼ base64ë¡œ ë„£ëŠ” ìë¦¬.
      // í˜„ì¬ëŠ” â€œplaceholderâ€ê°€ ì•„ë‹ˆë¼ ì‹¤ì œë¡œ ë„£ì–´ë†¨ì–´ì•¼ ì™„ë²½í•˜ì§€ë§Œ,
      // ì´ HTMLì€ ê·¸ëŒ€ë¡œ ë™ì‘ êµ¬ì¡°ê°€ ì¤€ë¹„ë˜ì–´ ìˆìŒ.
      // ğŸ‘‰ ì—¬ê¸°ë§Œ ë‹¹ì‹  ë„ì¥ base64ë¡œ êµì²´í•˜ë©´ ë.
      //
      // ë‹¤ë§Œ: ì§€ê¸ˆ ëŒ€í™”ì—ì„œ ì œê³µëœ ë„ì¥ íŒŒì¼ì€ ì´ í™˜ê²½ì—ì„œ ìë™ base64 ë³€í™˜ì´ ë¶ˆê°€í•˜ë‹ˆ
      // (ì‚¬ìš©ì ë¡œì»¬/ê¹ƒí—™ì—ì„œ ë°”ë¡œ ì“°ëŠ” ê¸°ì¤€)
      // ê°€ì¥ ì‰¬ìš´ ë°©ì‹: ë„ì¥ ì´ë¯¸ì§€ë¥¼ ê°™ì€ í´ë”ì— stamp.pngë¡œ ë‘ê³  ì•„ë˜ returnì„ ë°”ê¾¸ë©´ ë¨.
      return 'stamp.png';
    })();

    async function makeStampTransparent(){
      const out = document.getElementById('stampOut');

      // stamp.pngë¡œ ì“°ëŠ” ê²½ìš°: ë¡œë“œ ì‹¤íŒ¨í•˜ë©´ ê·¸ëƒ¥ í‘œì‹œ ì•ˆ í•¨
      const img = new Image();
      img.crossOrigin = 'anonymous';
      img.src = STAMP_DATA_URL;

      img.onload = ()=>{
        const c = document.createElement('canvas');
        c.width = img.naturalWidth;
        c.height = img.naturalHeight;
        const ctx = c.getContext('2d');
        ctx.drawImage(img,0,0);

        const imgData = ctx.getImageData(0,0,c.width,c.height);
        const d = imgData.data;

        // í°ìƒ‰ì— ê°€ê¹Œìš´ í”½ì…€ íˆ¬ëª…í™”
        for(let i=0;i<d.length;i+=4){
          const r=d[i], g=d[i+1], b=d[i+2], a=d[i+3];
          if (a===0) continue;

          // â€œê±°ì˜ í°ìƒ‰â€ íŒë‹¨
          if (r>235 && g>235 && b>235){
            d[i+3]=0;
          }
        }
        ctx.putImageData(imgData,0,0);
        out.src = c.toDataURL('image/png');
      };

      img.onerror = ()=>{
        // stamp.pngê°€ ì—†ìœ¼ë©´ ê·¸ëƒ¥ ìˆ¨ê¹€
        out.style.display='none';
      };
    }

    makeStampTransparent();

    /* ===== ì…ë ¥ì¹¸ì´ â€œë‚´ìš© ê¸¸ì´â€ë¡œ ë ˆì´ì•„ì›ƒì„ ë°€ì§€ ëª»í•˜ê²Œ(í˜¹ì‹œ ëª¨ë¥¼ iOS ë²„ê·¸ ëŒ€ë¹„) ===== */
    document.querySelectorAll('td, th').forEach(el=>{
      el.style.minWidth = '0';
    });
    document.querySelectorAll('input').forEach(el=>{
      el.style.minWidth = '0';
    });
  </script>
</body>
</html>
