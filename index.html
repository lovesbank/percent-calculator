<div class="integratedBox">
            <div class="integratedVal" id="integratedBal" style="display:none !important;">0</div>

            <div class="integratedMeta">
              <div class="metaLine1">
                <span class="editText" contenteditable="true">2025년 12월 31일</span>
              </div>
              <div class="metaLine2">
                <span class="editText" contenteditable="true">염전마을주민발전주식회사&nbsp;&nbsp;대표이사&nbsp;&nbsp;김진욱</span>
                <img src="stamp.PNG" class="ceoStamp" alt="직인">
              </div>
            </div>

            <img id="stampOut" class="stampOverlay" alt="직인">
          </div>

        </div> </div> </div> </div> <script>
    /* ===== iPhone “한 장 자동 축소” ===== */
    (function(){
      const wrap = document.getElementById('sheetWrap');
      const stage = document.querySelector('.stage');
      function px(v){ return Number(String(v).replace('px','')) || 0; }

      function fit(){
        const vw = document.documentElement.clientWidth;
        const base = parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--sheet-w')) || 920;

        const st = getComputedStyle(stage);
        const padL = px(st.paddingLeft);
        const padR = px(st.paddingRight);

        const usable = Math.max(320, vw - padL - padR);
        const scale = Math.min(1, usable / base);
        wrap.style.setProperty('--scale', scale.toFixed(4));
      }
      window.addEventListener('resize', fit, {passive:true});
      fit();
    })();

    function toNumber(v){
      if (v == null) return 0;
      const s = String(v).replace(/[^\d\-]/g,'');
      if (s === '' || s === '-') return 0;
      return Number(s) || 0;
    }
    function fmt(n){
      const sign = n < 0 ? '-' : '';
      const abs = Math.abs(Math.trunc(n));
      return sign + abs.toLocaleString('en-US');
    }
    function setInputFormatted(el){
      const n = toNumber(el.value);
      el.value = fmt(n);
    }

    document.querySelectorAll('input.money').forEach(el=>{
      el.addEventListener('input', ()=> {
        setInputFormatted(el);
        recalcAll();
      });
      setInputFormatted(el);
    });

    function sumInputs(selector){
      let s = 0;
      document.querySelectorAll(selector).forEach(el=>{ s += toNumber(el.value); });
      return s;
    }

    function recalcIncomeExpense(){
      const inc = sumInputs('#incomeExpenseTable .inc');
      const exp = sumInputs('#incomeExpenseTable .exp');
      const net = inc - exp;

      document.getElementById('incSum').value = fmt(inc);
      document.getElementById('expSum').value = fmt(exp);
      document.getElementById('netFoot').value = fmt(net);

      document.getElementById('net').value = fmt(net);

      const carry = toNumber(document.getElementById('carry').value);
      document.getElementById('endBal').value = fmt(carry + net);
    }

    function recalcBankOne(prefix, prevId, inSel, outSel, balSel, inSumId, outSumId, endId){
      let bal = toNumber(document.getElementById(prevId).value);
      let inSum = 0, outSum = 0;

      document.querySelectorAll(prefix + ' tbody tr').forEach(tr=>{
        const inEl  = tr.querySelector(inSel);
        const outEl = tr.querySelector(outSel);
        const balEl = tr.querySelector(balSel);

        const inn = inEl ? toNumber(inEl.value) : 0;
        const out = outEl ? toNumber(outEl.value) : 0;

        inSum += inn;
        outSum += out;

        bal = bal + inn - out;
        if (balEl) balEl.value = fmt(bal);
      });

      document.getElementById(inSumId).value = fmt(inSum);
      document.getElementById(outSumId).value = fmt(outSum);
      document.getElementById(endId).value = fmt(bal);

      return bal;
    }

    function recalcBank(){
      const ibEnd = recalcBankOne('#ibTable', 'ibPrev', '.ib-in', '.ib-out', '.ib-bal', 'ibInSum','ibOutSum','ibEnd');
      const nhEnd = recalcBankOne('#nhTable', 'nhPrev', '.nh-in', '.nh-out', '.nh-bal', 'nhInSum','nhOutSum','nhEnd');
      document.getElementById('integratedBal').textContent = fmt(ibEnd + nhEnd);
    }

    function recalcAll(){
      recalcIncomeExpense();
      recalcBank();
    }
    recalcAll();
  </script>
</body>
</html>







